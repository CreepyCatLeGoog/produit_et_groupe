import pandas as pd
import os
import re
from lxml import etree
import html
import chardet
import unicodedata

# === CONFIGURATION ===
# Ton mapping personnalis√©
MAPPING_BO_STEP = {'Z_CARACT_RANGTDEBOUT': 'ATS_RANGTDEBOUT_LOV', 'Z_CARACT_PIETSUROULETTE': 'ATS_PIETSUROULETTE_LOV', 'Z_CARACT_NORMLEVNF13697': 'ATS_NORMLEVNF13697', 'Z_CARACT_INSONORIS': 'ATS_INSONORIS', 'Z_CARACT_MATIERERECYCLEE': 'ATS_MATIERERECYCLEEP', 'Z_CARACT_TVCONNECTE': 'ATS_TVCONNECTE_LOV', 'Z_CARACT_BANDECAROLL': 'ATS_BANDECAROLL', 'Z_CARACT_NBRAMETCART': 'ATS_NBRAMETCART', 'Z_CARACT_TEMPSECHAGEMAXIDC': 'ATS_TEMPSECHAGEMAXIDC', 'Z_CARACT_BAVELXPRMM': 'ATS_BAVELXPRMM', 'Z_CARACT_COMPATIBILITEPAPIER': 'ATS_COMPATIBILITEPAPIER', 'Z_CARACT_COURSEVERINMM': 'ATS_COURSEVERINMM', 'Z_CARACT_PROTECTANTIUV': 'ATS_PROTECTANTIUV_LOV', 'Z_CARACT_VISCOSITE': 'ATS_VISCOSITE', 'Z_CARACT_TYPCONNEXION': 'ATS_TYPCONNEXION', 'Z_CARACT_TUNER': 'ATS_TUNER', 'non': 'ATS_OPT_EXCLUS', 'Z_CARACT_AMORTISPORTE': 'ATS_AMORTISSEURFERMPORTE_LOV', 'Z_CARACT_HAUTEURDATTEINTE_UM_METRE': 'ATS_HAUTEURDATTEINTE_UM', 'Z_CARACT_NUMRECTOV': 'ATS_NUMRECTOV', 'Z_CARACT_GARNISSAGE': 'ATS_GARNISSAGE', 'Z_CARACT_CANONPARECHOCS': 'ATS_CANONPARECHOCS_LOV', 'Z_CARACT_POTEAUDIAMCM': 'ATS_POTEAUDIAMCM', 'Z_CARACT_CERTIFNFHA': 'ATS_CERTIFNFHA_LOV', 'Z_CARACT_CARTMEMACC': 'ATS_CARTEMEMACC', 'Z_CARACT_UTILISATION': 'ATS_UTILISATION', 'Z_CARACT_ECOLABCYBL': 'ATS_ECOLABCYBL_LOV', 'Z_CARACT_DIAMCOUTO_UM.CM': 'ATS_DIAMLAME_UM', 'Z_CARACT_TYPEPRESSION': 'ATS_TYPEPRESSION', 'Z_CARACT_BALLASTINTGR': 'ATS_BALLASTINTEGRE', 'Z_CARACT_SENSIBILISO': 'ATS_SENSIBILISO', 'Z_CARACT_LARGEURCM': 'ATS_LARGEURCM', 'Z_CARACT_ENVOIDIFERE': 'ATS_ENVOIDIFERENBPAGE', 'Z_CARACT_FORMPANINFO': 'ATS_FORMPANINFO', 'Z_CARACT_NBRPROGRAMM': 'ATS_NBRPROGRAMM', 'Z_CARACT_OPTIMMSOFT': 'ATS_OPTIMMSOFT_LOV', 'Z_CARACT_FREQPROCGHZ': 'ATS_FREQPROCGHZ', 'Z_CARACT_CONNECTCARTSIM': 'ATS_CONNECTEURCARTESIM', 'Z_CARACT_ARMURE': 'ATS_ARMURE', 'Z_CARACT_TYPEPIECE': 'ATS_TYPEPIECE', 'Z_CARACT_TYPCOFFRET': 'ATS_TYPCOFFRET', 'Z_CARACT_TYPEDESALLE': 'ATS_TYPEDESALLE', 'Z_CARACT_FORMAT': 'ATS_FORMATSSUNITE', 'Z_CARACT_TYPEPROCESSEUR': 'ATS_TYPEPROCESSEUR', 'Balise ALT du site web.': 'ATS_BALISE_ALT_IMG_PRINCIPALE', 'Z_CARACT_POIDSCARTON_unece_unit_KGM': 'ATS_POIDSCARTON_UM', 'Z_CARACT_DENSDOSSKGMCU': 'ATS_DENSDOSSKGMCU', 'Z_CARACT_SUFAECMC': 'ATS_SUFAECMC', 'Z_CARACT_DUREEVALIDITE': 'ATS_DUREEVALIDITE', 'oui': 'ATD_PRIX_ACHAT_UGAP_EXW_FUTUR', 'Z_CARACT_POIDSG': 'ATS_POIDSG', 'Z_CARACT_MANCHETTE': 'ATS_MANCHETTE', 'Z_CARACT_TYPEPOIGNEE': 'ATS_TYPEPOIGNEE', 'Z_CARACT_SPEAKERINT': 'ATS_SPEAKERINT_LOV', 'Z_CARACT_SOURCBIOLOGIQUE': 'ATS_SOURCBIOLOGIQUE', 'Z_CARACT_ASSISELXPRCM': 'ATS_ASSISELXPRCM', 'Z_CARACT_TYPETELEPHONE': 'ATS_TYPETELEPHONE', 'Z_CARACT_MATRIOUEMBOUSECU': 'ATS_MATRIOUEMBOUSECU', 'Z_CARACT_LXHXPRCM': 'ATS_LXHXPRCM', 'Z_CARACT_EMBOUT': 'ATS_EMBOUT', 'Z_CARACT_CAPACCUVEAUL': 'ATS_CAPACCUVEAU_UM', 'Z_CARACT_PINCEPLATEAUMM': 'ATS_PINCEPLATEAUMM', 'Z_CARACT_DOSSERET': 'ATS_DOSSERET_LOV', 'Z_CARACT_NORMILITETANCH': 'ATS_NORMILITETANCH', 'Z_CARACT_FRANGES': 'ATS_FRANGES', 'Z_CARACT_NUMSCAN': 'ATS_NUMSCAN', 'Z_CARACT_VIMPAQC_UM_PAGEPARMINUTE': 'ATS_VIMPAQC_UM', 'Z_CARACT_REMPLOIUTILISATION': 'ATS_REMPLOIUTILISATION', 'Z_CARACT_INFOTRAFIC': 'ATS_INFOTRAFIC_LOV', 'Z_CARACT_POSITIONPANNEAU': 'ATS_POSITIONPANNEAU', 'Z_CARACT_PIETEMENT': 'ATS_PIETEMENT', 'Z_CARACT_HAUTGUIDON_UM_CM': 'ATS_HAUTGUIDON_UM', 'Z_CARACT_TYPCLASSEMENT': 'ATS_TYPCLASSEMENT', 'Z_CARACT_ANGLOUVERPORTESD': 'ATS_ANGLOUVERPORTESD', 'Z_CARACT_TYPERABAT': 'ATS_TYPERABAT', 'Z_CARACT_HORSTOUTLXHXPRCM': 'ATS_HORSTOUTLXHXPRCM', 'Z_CARACT_PERFSYSMARK': 'ATS_PERFSYSMARK', 'Z_CARACT_TYPETENUE': 'ATS_TYPETENUE', 'Z_CARACT_RSISTRUPTKN': 'ATS_RSISTRUPTKN', 'Z_CARACT_MATPORTEAV': 'ATS_MATPORTEAV', 'Z_CARACT_POCHESARRIRES': 'ATS_POCHESARRIRES', 'Z_CARACT_NBPASSAGMAX': 'ATS_NBPASSAGMAX', 'Z_CARACT_CONTROLEVOLUME': 'ATS_CONTROLEVOLUME_LOV', 'Z_CARACT_MATERIAUCORPS': 'ATS_MATERIAUCORPS', 'Z_CARACT_PUCTPMINT': 'ATS_PUCTPMINT', 'Z_CARACT_DONNEESECUR': 'ATS_DONNEESECUR', 'Z_CARACT_CONXSANSFIL': 'ATS_CONXIONSANSFIL', 'Z_CARACT_LIVRAISON': 'ATS_LIVRAISON', 'Z_CARACT_CARTRESEAUETHERN': 'ATS_CARTESEAUETHERN', 'Z_CARACT_POCHESAVANT': 'ATS_POCHESAVANT', 'Z_CARACT_VARIATRINT': 'ATS_VARIATRINT_LOV', 'Z_CARACT_MODELE': 'ATS_MODELE', 'Z_CARACT_RENDEMENSVKG': 'ATS_RENDEMENSVKG', 'M_OFFRE_RESP_CODEDD': 'ATS_OFFRE_DEVDURABLE_LOV', 'Z_CARACT_MATRIOBOUCLHARNAI': 'ATS_MATRIOBOUCLHARNAI', 'Z_CARACT_HAUTTRAM': 'ATS_HAUTTRAM', 'PICTO_UGAP_VL_FAIBLE_EMISSION': 'ATD_PRIX_VENTE_MODIFIE', 'Z_CARACT_FINITIONPIET': 'ATS_FINITIONPIET', 'Z_CARACT_COLORIS': 'ATS_COLORIS', 'Z_CARACT_SECTIONTUBMM': 'ATS_SECTIONTUBEMM', 'Z_CARACT_RECEPTEURGPS': 'ATS_RECEPTEURGPS', 'Z_CARACT_ASPIMCH': 'ATS_ASPIMCH', 'Z_CARACT_PLATEAU': 'ATS_PLATEAU', 'Z_CARACT_HTDIAHCM': 'ATS_HTDIAHCM', 'Z_CARACT_POURCENTMA': 'ATS_POURCENTMAP', 'Z_CARACT_TBIHORSCM': 'ATS_TBIHORSTCM', 'SAE_VL_SI_AUDIO_VEHICULE': 'ATS_SI_AUDIO_VEHICULE', 'Z_CARACT_HORSTOUTLXHXEPCM': 'ATS_HORSTOUTLXHXEPCM', 'SAE_VL_PACK': 'ATS_PACK_UGAP_LOV', 'Z_CARACT_MATACOUDOIR': 'ATS_MATACOUDOIR', 'Z_CARACT_LANGAGEMUL': 'ATS_LANGAGEMUL', 'Z_CARACT_LONGCOUPCM': 'ATS_LONGCOUPCM', 'Z_CARACT_NUMINST': 'ATS_NUMINST_LOV', 'Z_CARACT_TYPTAITANTIACARIEN': 'ATS_TYPTAITANTIACARIEN', 'Z_CARACT_PILOTAGE': 'ATS_PILOTAGE', 'Z_CARACT_THERMOSTATREGUL': 'ATS_THERMOSTATREGUL', 'Z_CARACT_BLANCHEURCIE': 'ATS_BLANCHEURCIE', 'Z_CARACT_TECHNODALLE': 'ATS_TECHNODALLE', 'Z_CARACT_DOUBLURE': 'ATS_DOUBLURE', 'Z_CARACT_ARIERENFORC': 'ATS_ARRIERERENFORCE_LOV', 'Z_CARACT_PRODUITVERT': 'ATS_PRODUITVERT_LOV', 'Z_CARACT_SYSTEMEOUVERT': 'ATS_SYSTEMEOUVERT', 'Z_CARACT_CATGORIMARQUAG': 'ATS_CATEGORIEMARQUAG', 'Z_CARACT_VISIREMM': 'ATS_VISIREMM', 'Z_CARACT_PRODUIT_RESPONSABLE': 'ATS_PRODUIT_RESPONSABLE_LOV', 'Z_CARACT_TYPEDECLOISON': 'ATS_TYPEDECLOISON', 'Z_CARACT_NBCARAC': 'ATS_AFFICHAGENBRECARAC', 'Z_CARACT_COULEUR': 'ATS_COULEUR', 'Z_CARACT_ENVIRONSUPPORTE': 'ATS_ENVIRONSUPPORTE', 'Z_CARACT_FINITIONPOTEAU': 'ATS_FINITIONPOTEAU', 'Z_CARACT_NBTYPROUE': 'ATS_TYPROUES', 'Z_CARACT_FORMATFEUILLE': 'ATS_FORMATFEUILLE', 'Z_CARACT_CHARIOTDEMONT': 'ATS_CHARIOTDEMONT_LOV', 'Z_CARACT_USAGEUNIQUE': 'ATS_USAGEUNIQUE_LOV', 'Z_CARACT_POIDSPALET_unece_unit_KGM': 'ATS_POIDSPALET_UM', 'Z_CARACT_LONGUEURCM': 'ATS_LONGUEURCM', 'Z_CARACT_MODE_UM_BITPARSECONDE': 'ATS_MODEM_UM', 'SAE_VL_SEGMENT': 'ATS_SEGMENT_MKTG_VL_LOV', 'Z_CARACT_NETTJETDOUCH': 'ATS_NETTJETDOUCH_LOV', 'Z_CARACT_CITERNEEAU_UM_LITRE': 'ATS_CAPACITECITERNEEAU_UM', 'Z_CARACT_MATENJOLIVEUR': 'ATS_MATENJOLIVEUR', 'Z_CARACT_MATERIAU': 'ATS_MATERIAU', 'Z_CARACT_TPSPRECHAUFS_UM_SECONDE': 'ATS_TPSPRECHAUF_UM', 'Z_CARACT_TRANCHEAGE': 'ATS_TRANCHEAGE', 'Z_CARACT_RSISTRUPTSYSTMLIAISOKN': 'ATS_RSISTRUPTSYSTMLIAISOKN', 'Z_CARACT_NBRPRISESIEC': 'ATS_NBRPRISESIEC', 'Z_CARACT_FIXVESALXLMM': 'ATS_FIXVESALXLMM', 'SAE_VL_CAPTEUR_DIST_STATIONT': 'ATS_CAPTEUR_DIST_STATIONT', 'Z_CARACT_DILUTIONPC': 'ATS_DILUTIONPC', 'Z_CARACT_MODELORDIRPORTAB': 'ATS_MODELORDIRPORTAB', 'Z_CARACT_CASIERUTILLXHXPRCM': 'ATS_CASIERUTILLXHXPRCM', 'Z_CARACT_MATPLAQUE': 'ATS_MATPLAQUE', 'Z_CARACT_CAPACITERELIURE': 'ATS_CAPACITERELIURE', 'Z_CARACT_MICROPHONE': 'ATS_MICROPHONE_LOV', 'Z_CARACT_MARQUER': 'ATS_MARQUER', 'Z_CARACT_MATPORTE': 'ATS_MATPORTE', 'Z_CARACT_AUTOALIM': 'ATS_AUTOALIMENTE_LOV', 'Z_CARACT_TEXTUR': 'ATS_TEXTUR', 'Z_CARACT_RSISTRUPTANCRAGKN': 'ATS_RSISTRUPTANCRAGKN', 'Z_CARACT_PRODUITSIMILAIRES': 'ATS_REFFABSIMILAIRE', 'Z_CARACT_TYPBLANCHEUR': 'ATS_TYPBLANCHEUR', 'Z_CARACT_TAILCOUPMM': 'ATS_TAILCOUPMM', 'Z_CARACT_GERBAGE': 'ATS_GERBAGE', 'Z_CARACT_FONCTSPEC': 'ATS_FONCTSPEC', 'Z_CARACT_MATERIAUMANCHE': 'ATS_MATERIAUMANCHE', 'Z_CARACT_PROTECID': 'ATS_PROTECID', 'Z_CARACT_LXHXEPCM': 'ATS_LXHXEPCM', 'Z_CARACT_CODEIEC': 'ATS_CODEIEC', 'Z_CARACT_POITOTLO_unece_unit_KGM': 'ATS_POITOTLO_UM', 'Z_CARACT_MATERIAUBRAS': 'ATS_MATERIAUBRAS', 'Z_CARACT_NBAIGUILLES': 'ATS_NBAIGUILLES', 'Z_CARACT_COPAUTONOM': 'ATS_COPAUTONOM_LOV', 'Z_CARACT_TYPBOUCLHARNAI': 'ATS_TYPBOUCLHARNAI', 'Z_CARACT_CATGORIDEPI': 'ATS_CATEGORIEDEPI', 'Z_CARACT_DECOUPSOUDSIMUL': 'ATS_DECOUPSOUDSIMUL_LOV', 'Z_CARACT_TYPCOLORATION': 'ATS_TYPCOLORATION', 'Z_CARACT_BTHAUTMAXICM': 'ATS_BTHAUTMAXI_UM', 'Z_CARACT_FORMANUM': 'ATS_FORMANUM', 'Z_CARACT_DUREVIESOURCELUMH': 'ATS_DUREVIESOURCELUMH', 'Z_CARACT_LONGBARSOUDURECM': 'ATS_LONGBARSOUDURE_UM', 'Z_CARACT_CAPACITECL': 'ATS_CAPACITECL', 'Z_CARACT_MATMASQUE': 'ATS_MATMASQUE', 'Z_CARACT_CLASSATEX': 'ATS_CLASSIFICATIONATEX', 'Z_CARACT_DENOCOM': 'ATS_DENOCOM', 'Z_CARACT_MOSPHTLHPRCM': 'ATS_MOSPHTLHPRCM', 'Z_CARACT_OUVERTURMM': 'ATS_OUVERTURMM', 'Z_CARACT_LIVREPLAT': 'ATS_LIVREPLAT_LOV', 'Z_CARACT_PROJMINMAXM': 'ATS_PROJMINMAXM', 'Z_CARACT_GRADE': 'ATS_GRADE', 'Z_CARACT_ADMISTRABLE': 'ATS_ADMISTRABLE', 'Z_CARACT_COMPATIBILITEGEL': 'ATS_COMPATIBILITEGEL', 'Z_CARACT_HORSTOUTLHPRMM': 'ATS_HORSTOUTLHPRMM', 'SAE_VL_NB_PLACES_VEHICULES': 'ATS_NB_PLACES_VEHICULES', 'Z_CARACT_RESEAU': 'ATS_RESEAU', 'Z_CARACT_TYPEFERM': 'ATS_TYPEFERMETURE', 'Z_CARACT_COMPTAMPONPC': 'ATS_COMPTAMPONPC', 'Z_CARACT_NBMOTEUR': 'ATS_NBMOTEUR', 'Z_CARACT_NBREECHELONS': 'ATS_NBREECHELONS', 'Z_CARACT_ALIMORIGINBF': 'ATS_ALIMORIGINBF', 'Z_CARACT_ZOOMPC': 'ATS_ZOOMPC', 'Z_CARACT_HTPLATFORMMM': 'ATS_HTPLATFORMMM', 'Z_CARACT_TYPOINTE': 'ATS_TYPOINTE', 'Z_CARACT_INDICEDEFILTRAT': 'ATS_INDICEDEFILTRAT', 'Z_CARACT_CONEXTENSIOSL': 'ATS_CONEXTENSIOSL', 'Z_CARACT_CONDITION': 'ATS_CONDITIONNEMENT', 'Z_CARACT_IRCRA': 'ATS_IRCRA', 'Z_CARACT_DISPODESSACS': 'ATS_DISPODESSACS', 'Z_CARACT_LIMITQUANTIFPPB': 'ATS_LIMITQUANTIFPPB', 'ED_SYSTEME_EXPLOITATION_MULTIEDITEURS': 'ATS_ED_SYSTEXPLOITMULTIEDITEUR', 'Z_CARACT_TAILECRA': 'ATS_TAILLEDECRAN', 'Z_CARACT_LOGISUPERVISION': 'ATS_LOGISUPERVISION', 'Z_CARACT_CONNECTIVITE': 'ATS_CONNECTIVITE', 'Z_CARACT_MATRIOCORDELET': 'ATS_MATRIOCORDELET', 'Z_CARACT_ODEUR': 'ATS_ODEUR', 'Z_CARACT_VERSION': 'ATS_VERSION', 'Z_CARACT_ETIQLHMM': 'ATS_ETIQLHMM', 'Z_CARACT_COLORGAINCAB': 'ATS_COLORISGAINCAB', 'Z_CARACT_PROFONDASSISECM': 'ATS_PROFONDEURASSISE_UM', 'Z_CARACT_LAIZE_UM': 'ATS_LAIZE_UM', 'Z_CARACT_PRISECASQUE': 'ATS_PRISECASQUE_LOV', 'Z_CARACT_VITCOPIMPA4': 'ATS_VITCOPIMPA4', 'Z_CARACT_NBPORTUSB': 'ATS_NBPORTUSB', 'Z_CAPACITEBACL': 'ATS_CAPACITEBACEAU_UM', 'Z_CARACT_TECHNIQEXTRACTION': 'ATS_TECHNIQEXTRACTION', 'Z_CARACT_DIFECLAIRAGE': 'ATS_DIFECLAIRAGE', 'Z_CARACT_MEMOIREGO': 'ATS_MEMOIREGO', 'Z_CARACT_TORCHEINTEGREE': 'ATS_TORCHEINTEGREE_LOV', 'Z_CARACT_ELECTRIFICATION': 'ATS_ELECTRIFICATION', 'Z_CARACT_HTSSPIEDLXHXPRCM': 'ATS_HTSSPIEDLXHXPRCM', 'Z_CARACT_PUISHTPARLW': 'ATS_PUISSANCEHAUTPARLEURW', 'Z_CARACT_MATERIOCAR': 'ATS_MATERIOCAR', 'Z_CARACT_FONCTIONRDS': 'ATS_FONCTIONRDS_LOV', 'Z_CARACT_VITRANSMSP_UM_SECONDE': 'ATS_VITRANSMSP_UM', 'Z_CARACT_CAPACITEBATAH': 'ATS_CAPACITEBATAH', 'Z_CARACT_HAUTEURDEPLIE': 'ATS_HAUTHTOUTREPDEPM', 'Z_CARACT_TABLETTEDS': 'ATS_TABLETTEDS', 'Z_CARACT_FORMMAXORIGIN': 'ATS_FORMMAXORIGIN', 'Z_CARACT_USINAGEDENTS': 'ATS_USINAGEDENTS', 'Z_CARACT_TEMPUTILMAXDC': 'ATS_TEMPUTILMAXDC', 'Z_CARACT_CARTEMEMOIRE': 'ATS_CARTEMEMOIRE', 'SAE_VL_AIR_CONDITIONNE_VEHICULE': 'ATS_AIR_CONDITIONNE_VEHICULE', 'Z_CARACT_TYPEFIXATION': 'ATS_TYPEFIXATION', 'Z_CARACT_ALIMENTATIONV': 'ATS_ALIMENTATIONV', 'Z_CARACT_COMPOSITION': 'ATS_COMPOSITION', 'Z_CARACT_REGLABLE': 'ATS_REGLABLE_LOV', 'Z_CARACT_MATRIAUOCULAIR': 'ATS_MATRIAUOCULAIR', 'Z_CARACT_CHLORE': 'ATS_CHLORE', 'Z_CARACT_TYPECAPTEUR': 'ATS_TYPECAPTEUR', 'Z_CARACT_EQUIPINCENDIE': 'ATS_EQUIPINCENDIE_LOV', 'Z_CARACT_MODULTROIG': 'ATS_MODULTROIG', 'Z_CARACT_NBFEUILRAM': 'ATS_NBFEUILRAM', 'Z_CARACT_TYPEGRAVEUR': 'ATS_TYPEGRAVEUR', 'Z_CARACT_MAINSLIBRES': 'ATS_MAINSLIBRES_LOV', 'Z_CARACT_CAPACCUVDECHMC': 'ATS_CAPACCUVDECH_UM', 'Z_CARACT_BORDSRAYONNS': 'ATS_BORDSRAYONNS_LOV', 'CO2': 'ATS_CO2', 'Z_CARACT_TYPEPACK': 'ATS_TYPEPACK', 'Z_CARACT_MODEAFFICHAGE': 'ATS_MODEAFFICHAGE', 'Z_CARACT_MEMOIREMO': 'ATS_MEMOIREMO', 'Z_CARACT_GARDECORPSHMM': 'ATS_HGARDECORPS_UM', 'Z_CARACT_SORT1ERCOPC': 'ATS_SORT1ERCOPC', 'Z_CARACT_TEMPLAVAGEDEGC': 'ATS_TEMPLAVAGEDEGC', 'Z_CARACT_RUBLARG_UM_MILLIMETRE': 'ATS_RUBLARG_UM', 'Z_CARACT_SCURITSTRUC': 'ATS_SCURITSTRUC', 'PICTO_UGAP_VEHICULES_COMMANDABLES': 'ATS_PICTO_UGAP_VEHICULES_COMMANDABLE_LOV', 'Z_CARACT_EPMAX_UM_MICROMETRE': 'ATS_EPMAX_UM', 'Z_CARACT_SUPPORTENREGIST': 'ATS_SUPPORTENREGIST', 'Z_CARACT_ASSEMBLAGE': 'ATS_ASSEMBLAGE', 'Z_CARACT_AUTONOMIE': 'ATS_AUTONOMIE', 'Z_CARACT_SORT1ERCOPN': 'ATS_SORT1ERCOPN', 'Z_CARACT_MENTONNIRE': 'ATS_MENTONNIRE_LOV', 'Z_CARACT_TYPTIROIROP': 'ATS_TYPTIROIROP', 'Z_CARACT_GARANTIE': 'ATS_GARANTIE', 'Z_CARACT_ANTIVANDAL': 'ATS_ANTIVANDALISME_LOV', 'Z_CARACT_CONNECTCLAVTAB': 'ATS_CONNECTEURCLAVTAB', 'Z_CARACT_CAPNBCLE': 'ATS_CAPACITENBCLE', 'Z_CARACT_FIXATION': 'ATS_FIXATION', 'Z_CARACT_PUISSANCE_UM_VOLTAMPERE': 'ATS_PUISSANCE_UM', 'Z_CARACT_COL': 'ATS_COL', 'Z_CARACT_NBRCASES': 'ATS_NBRCASES', 'Z_CARACT_FCTTELECOPIEUR': 'ATS_FCTTELECOPIEUR_LOV', 'Z_CARACT_NBLIGNE': 'ATS_NBLIGNE', 'Z_CARACT_TIRLHPRUTMM': 'ATS_TIRLHPRUTMM', 'Z_CARACT_TEXTUREFINITIONPAPIER': 'ATS_TEXTUREFINITIONPAPIER', 'Z_CARACT_TEMPSPRISE': 'ATS_TEMPSPRISE', 'Z_CARACT_SOCLEMAGN': 'ATS_SOCLEMAGN_LOV', 'Z_CARACT_CORDELETTE': 'ATS_CORDELETTE', 'Z_CARACT_DENSITE': 'ATS_DENSITE', 'Z_CARACT_TYPEADHESIF': 'ATS_TYPEADHESIF', 'Z_CARACT_PROTECTION': 'ATS_PROTECTION', 'Z_CARACT_TAUXENDOTOXINE': 'ATS_TAUXENDOTOXINE', 'Z_CARACT_SOCLELXLCM': 'ATS_SOCLELXLCM', 'Z_CARACT_CLASFEU': 'ATS_CLASSFEU', 'Z_CARACT_CARENE': 'ATS_CARENE', 'Z_CARACT_BANDEAU': 'ATS_BANDEAU', 'Z_CARACT_HAUTPLATCM': 'ATS_HAUTPLATCM', 'Z_CARACT_TYPANTIBIOTIQUE': 'ATS_TYPANTIBIOTIQUE', 'Z_CARACT_CITERNEEMULSEUR_UM_LITRE': 'ATS_CAPACITECITERNEEMULSEUR_UM', 'VL_FAIBLE_EMISSION': 'ATS_FAIBLES_EMISSIONS_LOV', 'Z_CARACT_BUTDARTTIROIR': 'ATS_BUTDARTTIROIR_LOV', 'Z_CARACT_BANDRTRORFLECH': 'ATS_BANDRTRORFLECH', 'Z_CARACT_TEMPSDEPLOIEMENT': 'ATS_TEMPSDEPLOIEMENT', 'SAE_VL_BOITE': 'ATS_TYPE_BOITE_VITESSE', 'Z_CARACT_SOCLEDIAMCM': 'ATS_SOCLEDIAMCM', 'Z_CARACT_PENLXHXPRUTCM': 'ATS_PENLXHXPRUTCM', 'Z_CARACT_BRATIMONDEG': 'ATS_BRATIMONDEG', 'Z_CARACT_PIVOTEMENTECRDEG': 'ATS_PIVOTEMENTECRDEG', 'Z_CARACT_TEMPLAVAGEMAXIDC': 'ATS_TEMPLAVAGEMAXI', 'Z_CARACT_TYPETIQUETAC': 'ATS_TYPETIQUETAC', 'Z_CARACT_VITIMP': 'ATS_VITIMP', 'Z_CARACT_TAILLECARACMM': 'ATS_TAILLECARACMM', 'Z_CARACT_MATROUE': 'ATS_MATROUE', 'Z_CARACT_AVMONNAYEUR': 'ATS_AVECMONNAYEUR_LOV', 'Z_CARACT_HORSTOUTLXLXHMM': 'ATS_HORSTOUTLXLXHMM', 'Z_CARACT_SUPPORT': 'ATS_SUPPORT', 'Z_CARACT_NORMECERTIFICATION': 'ATS_NORMECERTIFICATION', 'Z_CARACT_ALIMENTATION': 'ATS_ALIMENTATION', 'Z_CARACT_RESISTGLISSEMEN': 'ATS_RESISTGLISSEMEN', 'Z_CARACT_MULTICOPI': 'ATS_MULTICOPI', 'Z_CARACT_TYPELECTURE': 'ATS_TYPELECTURE', 'Z_CARACT_DESCRIPTIF': 'ATS_DESCRIPTIF', 'Z_CARACT_LARGMM': 'ATS_LARGMM', 'Z_CARACT_NBPERSONNES': 'ATS_NBPERSONNES', 'Z_CARACT_DOSSIERLXHCM': 'ATS_DOSSIERLXHCM', 'SAE_VL_TYPE_IMMATRICULATION': 'ATS_TYPE_IMMATRICULATION_JATO', 'Z_CARACT_RESOLECRAN': 'ATS_RESOLECRAN', 'Z_CARACT_NORMWIFI': 'ATS_NORMWIFI', 'Z_CARACT_SITEUTIL': 'ATS_SITEUTIL', 'Z_CARACT_CAPACITNBRCOUTO': 'ATS_CAPACITENBCOUTO', 'Z_CARACT_EPAISPLANTRAVCM': 'ATS_EPAISPLANTRAV_UM', 'Z_CARACT_SURFTRAITEEMC': 'ATS_SURFTRAITEE_UM', 'Z_CARACT_PIVOTANT': 'ATS_PIVOTANT_LOV', 'Z_CARACT_STERILE': 'ATS_STERILE', 'Z_CARACT_INDICNIVO': 'ATS_INDICNIVO', 'Z_CARACT_MATREFLECTR': 'ATS_MATREFLECTR', 'Z_CARACT_VINUMONO': 'ATS_VINUMONO', 'Z_CARACT_TYPOINTAG': 'ATS_TYPOINTAG', 'Z_CARACT_AFFUTSEPARE': 'ATS_AFFUTEUR_LOV', 'Z_CARACT_LESTAGE': 'ATS_LESTAGE', 'Z_CARACT_LARGEURFOND': 'ATS_LARGEURFOND_UM', 'Z_CARACT_NORME': 'ATS_NORME', 'Z_CARACT_HAUTPLATEFORMECM': 'ATS_HAUTPLATEFORMECM', 'Z_CARACT_COLORIENCR': 'ATS_COLORISENCR', 'Z_CARACT_REPOSEPIED': 'ATS_REPOSEPIED', 'Z_CARACT_PDSMAXECRANKG': 'ATS_PDSMAXECRANKG', 'Z_CARACT_ECNBLIGNES': 'ATS_ECNBLIGNES', 'Z_CARACT_PORTEFOP_UM_METRE': 'ATS_PORTEFOP_UM', 'Z_CARACT_REFLCTRDIAMMM': 'ATS_REFLCTRDIAM_UM', 'Z_CARACT_RSISTRUPTSANGLKN': 'ATS_RSISTRUPTSANGLKN', 'Z_CARACT_TYPERESTRICT': 'ATS_TYPERESTRICT', 'Z_CARACT_NUMTRANSP': 'ATS_NUMTRANSP_LOV', 'Z_CARACT_MAPANO': 'ATS_MAPANO', 'Z_CARACT_PEFCAGREMENT': 'ATS_PEFCAGREMENT', 'Z_CARACT_DEBIAIRLIBMCH': 'ATS_DEBITAIRLIBMCH', 'Z_CARACT_TYPAPPAREIL': 'ATS_TYPAPPAREIL', 'Z_CARACT_VIMP_UM_PAGEPARMINUTE': 'ATS_VIMP_UM', 'SAE_VL_COMMANDABLE': 'ATS_SAE_VL_COMMANDABLE_LOV', 'Z_CARACT_TYPERECHARGE': 'ATS_TYPERECHARGE', 'Z_CARACT_FORMATABLEAU': 'ATS_FORMATABLEAU', 'Z_CARACT_TYPAGRAFE': 'ATS_TYPAGRAFE', 'Z_CARACT_RESISTESSIEUT': 'ATS_RESISTESSIEUT', 'Z_CARACT_NBPIECES': 'ATS_NBPIECES', 'Z_CARACT_TYPJET': 'ATS_TYPJET', 'Z_CARACT_HAUTDOSSMM': 'ATS_HAUTDOSSMM', 'Z_CARACT_LOGINUMAC': 'ATS_LOGINUMAC', 'Z_CARACT_NIVTOASTAGE': 'ATS_NIVTOASTAGE', 'Z_CARACT_MEMOIRINTMO': 'ATS_MEMOIRINTMO', 'SAE_VL_SILHOUETTE': 'ATS_SILHOUETTE_VEHICULE', 'Z_CARACT_CARTEMEMOIRESUP': 'ATS_CARTEMEMOIRESUP', 'Z_CARACT_RESOLECRANP': 'ATS_RESOLECRANPX', 'Z_CARACT_GOMME': 'ATS_GOMME', 'Z_CARACT_NBUTLISATEURS': 'ATS_NBUTLISATEURS', 'Z_CARACT_HTDEPLIELXLCM': 'ATS_HTDEPLIELXLCM', 'Z_CARACT_NBRIDEL': 'ATS_NBRIDEL', 'Z_CARACT_FERMETURE': 'ATS_FERMETURE', 'Z_CARACT_PRASSIETDIAMXCM': 'ATS_PRASSIETDIAMXCM', 'Z_CARACT_LOGFOURNIS': 'ATS_LOGFOURNIS', 'Z_CARACT_MODECORKEY': 'ATS_MODECORKEY', 'Z_CARACT_MATRIDEAU': 'ATS_MATRIDEAU', 'Z_CARACT_LARGTRAVMM': 'ATS_LARGTRAV_UM', 'Z_CARACT_DIMENSIONCM': 'ATS_DIMENSIONCM', 'Z_CARACT_CONNECTIQ': 'ATS_CONNECTIQUE', 'Z_CARACT_TUBELXLMM': 'ATS_TUBELXLMM', 'Z_CARACT_MODELTABL': 'ATS_MODELTABL', 'Z_CARACT_PROFMM': 'ATS_PROFONDEUR_UM', 'Z_CARACT_CERTIFISV': 'ATS_CERTIFISV', 'Z_CARACT_PLATEAULXLMM': 'ATS_PLATEAULXLMM', 'SAE_VL_WLTP_NOX': 'ATS_WLTP_NOX', 'Z_CARACT_NIVEAUSONOREDB': 'ATS_NIVEAUSONOREDB', 'Z_CARACT_NBFORMATS': 'ATS_NBFORMATS', 'Z_CARACT_TYPTOUCHE': 'ATS_TYPTOUCHE', 'Z_CARACT_IMPERRESPIRANT': 'ATS_IMPERRESPIRANT', 'Z_CARACT_LONGGUIDCM': 'ATS_LONGGUIDCM', 'Z_CARACT_MATUSURFJEU': 'ATS_MATUSURFJEU', 'Z_CARACT_CAPDESHUMIDLJ': 'ATS_CAPDESHUMIDLJ', 'Z_CARACT_CAPACITECUVEL': 'ATS_CAPACITECUVEL', 'Z_CARACT_INTERFACEDISQUEDUR': 'ATS_INTERFACEDISQUEDUR', 'Z_CARACT_NBPERSMONTAGE': 'ATS_NBPERSMONTAGE', 'Z_CARACT_ADAPTEPMR': 'ATS_ADAPTPMR_LOV', 'Z_CARACT_CAPNBFEUIL80': 'ATS_CAPACITENBFEUIL80', 'Z_CARACT_DENSITEGML': 'ATS_DENSITEGML', 'Z_CARACT_SURFACTIONMCA': 'ATS_SURFACTION.UM', 'Z_CARACT_CARTESON': 'ATS_CARTESON', 'Z_CARACT_LOGIRETIMAGE': 'ATS_LOGIRETIMAGE_LOV', 'Z_CARACT_LOGIARCHIVA': 'ATS_LOGIARCHIVA_LOV', 'Z_CARACT_FINITION': 'ATS_FINITION', 'Z_CARACT_CAPACAUTOPROTCAL': 'ATS_CAPACAUTOPROTCAL', 'Z_CARACT_TYPCONVERT': 'ATS_TYPCONVERT', 'Z_CARACT_CAPACITESACL': 'ATS_CAPACITESACL', 'Z_CARACT_INDICE_REPARABILITE': 'ATS_INDICE_REPARABILITE', 'Z_CARACT_LONGESYSTMLIAISOMM': 'ATS_LONGESYSTMLIAISOMM', 'Z_CARACT_RSISTRUPTCONECTKN': 'ATS_RSISTRUPTCONECTKN', 'Z_CARACT_DOSSIER': 'ATS_DOSSIER', 'Z_CARACT_WEBCAM': 'ATS_WEBCAM', 'Z_CARACT_LSYSTMELIAISOM': 'ATS_LSYSTMELIAISOM', 'Z_CARACT_POINTURE': 'ATS_POINTURE', 'Z_CARACT_MATERIAUMARCHE': 'ATS_MATERIAUMARCHE', 'Z_CARACT_HORSTOUTLXLXHCM': 'ATS_HORSTOUTLXLXHCM', 'Z_CARACT_INFOPANNEAU': 'ATS_INFOPANNEAU', 'Z_CARACT_CAPSEAUL': 'ATS_CAPSEAUL', 'Z_CARACT_NBPORTPOESDCM': 'ATS_NBPORTPOESDCM', 'Z_CARACT_DISQDIAMMM': 'ATS_DISQDIAMMM', 'Z_CARACT_SOUSMAIN': 'ATS_SOUSMAIN_LOV', 'Z_CARACT_ZOOMOPNUM': 'ATS_ZOOMOPNUM', 'Z_CARACT_TYPIL': 'ATS_TYPIL', 'Z_CARACT_EPAISSEURREPLIE_UM': 'ATS_EPAISSEURREPLIE_UM', 'Z_CARACT_INSTALLATION': 'ATS_INSTALLATION', 'Z_CARACT_CLAVIERDETACH': 'ATS_CLAVIERDETACH', 'Z_CARACT_CAPACITEMINIMEM': 'ATS_CAPACITEMINIMEM', 'Z_CARACT_CHARGMAXTAB_unece.unit.KGM': 'ATS_CHARGEMAXTAB_UM', 'Z_CARACT_SYLEVAGE': 'ATS_SYLEVAGE', 'Z_CARACT_AMENAGINTER': 'ATS_AMENAGEMENTINTERIEUR', 'Z_CARACT_OPACITE_UM_POURCENT': 'ATS_OPACITE_UM', 'Z_CARACT_NBBARREAUX': 'ATS_NBBARREAUX', 'Z_CARAC_TIRLHPRUTCM': 'ATS_TIRLHPRUTCM', 'Z_CARACT_DEBITPH': 'ATS_DEBITPH', 'Z_CARACT_DIABAROMM': 'ATS_DIABAROMM', 'Z_CARACT_PERTURBENDOCRIN': 'ATS_PERTURBENDOCRIN', 'Z_CARACT_TYPVENTIL': 'ATS_TYPVENTIL', 'Z_CARACT_DISTRIBUTION': 'ATS_DISTRIBUTION', 'Z_CARACT_BRANCHESRGLABL': 'ATS_BRANCHESRGLABL', 'Z_CARACT_NBPRISES': 'ATS_NBPRISES', 'Z_CARACT_CONFIGMINREQUISE': 'ATS_CONFIGMINREQUISE', 'Z_CARACT_CONSOMMATION': 'ATS_CONSOMMATION', 'Z_CARACT_MARCHARET': 'ATS_MARCHARET_LOV', 'Z_CARACT_SEQUENCAGE': 'ATS_SEQUENCAGE', 'Z_CARACT_MATERIAUASSISE': 'ATS_MATERIAUASSISE', 'Z_CARACT_TYPFIBROP': 'ATS_TYPFIBROP', 'Z_CARACT_GARANTSTANDARD': 'ATS_GARANTSTANDARD', 'Z_CARACT_PLATEAUDIACM': 'ATS_PLATEAUDIACM', 'Z_CARACT_AJUSTOURTETE': 'ATS_AJUSTOURTETECM', 'Z_CARACT_FONCTSCANNER': 'ATS_FONCTSCANNER_LOV', 'Z_CARACT_POIGNTRANSPORT': 'ATS_POIGNTRANSPORT_LOV', 'Z_CARACT_TYPEPOTEAU': 'ATS_TYPEPOTEAU', 'Z_CARACT_MINUTERIEMIN': 'ATS_MINUTERIEMIN', 'Z_CARACT_NBPORTSDCM': 'ATS_NBPORTSDCM', 'Z_CARACT_HAUTLAME_UM_CM': 'ATS_HAUTLAME_UM', 'Z_CARACT_AUTONOMIVCH': 'ATS_AUTONOMIVCH', 'Z_CARACT_HAUTEURACCESMM': 'ATS_HAUTEURACCESMM', 'Z_CARACT_LIVREAVEC': 'ATS_LIVREAVEC', 'Z_CARACT_NIVDIFFICULTE': 'ATS_NIVDIFFICULTE', 'Z_CARACT_DISQUEDURGO': 'ATS_CAPDISQUEDURGO', 'Z_CARACT_VIMPATC_UM_PAGEPARMINUTE': 'ATS_VIMPATC_UM', 'Z_CARACT_PONORME': 'ATS_PONORME', 'Z_CARACT_LUMINOSITCDMC': 'ATS_LUMINOSITE_UM', 'Z_CARACT_NBCPPEDHMAX': 'ATS_NBCPPEDHMAX', 'Z_CARACT_LONGHTCM': 'ATS_LONGHTCM', 'Z_CARACT_CAPTEURDTECT': 'ATS_CAPTEURDTECT', 'Z_CARACT_MODE': 'ATS_MODE', 'SAE_VL_COLORIS': 'ATS_COLORIS_BLANC_VL_LOV', 'Z_CARACT_HTIGMATEL': 'ATS_HTIGMATEL', 'Z_CARACT_DENATURANT': 'ATS_DENATURANT', 'Z_CARACT_STABSTATDBM': 'ATS_STABSTATDBM', 'Z_CARACT_NBREPRESEL': 'ATS_NBREPRESEL', 'Z_CARACT_HTEURENAPPUI_UM': 'ATS_HAUTEURAPPUI_UM', 'Z_CARACT_MATRIOCONECT': 'ATS_MATRIOCONECT', 'Z_CARACT_TYPELIQUIDE': 'ATS_TYPELIQUIDE', 'Z_CARACT_WIFI': 'ATS_WIFI_LOV', 'Z_CARACT_FREQUENCEHZ': 'ATS_FREQUENCEHZ', 'Z_CARACT_NBANNEAU': 'ATS_NBANNEAU', 'Z_CARACT_NBCOMPARTIMEN': 'ATS_NBRECOMPARTIMENTS', 'Z_CARACT_FREQUENCE': 'ATS_FREQUENCE', 'Z_CARACT_LARGANCRAGEMM': 'ATS_LARGANCRAGEMM', 'Z_CARACT_MATDISQUE': 'ATS_MATDISQUE', 'Z_CARACT_NORMSPORICID': 'ATS_NORMSPORICID_LOV', 'Z_CARACT_RUBLONGM': 'ATS_RUBLONGM', 'Z_CARACT_ATTESTCONCEPTYPE': 'ATS_ATTESTCONCEPTYPE_LOV', 'Z_CARACT_COLORPIETEMENT': 'ATS_COLORISPIETEMENT', 'Z_CARACT_ENCOCHCABLESECU': 'ATS_ENCOCHCABLESECU', 'Z_CARACT_NBETAGES': 'ATS_NBETAGES', 'Z_CARACT_TYPRIDEL': 'ATS_TYPRIDEL', 'Z_CARACT_HAUTLEVMIMXMM': 'ATS_HAUTLEVMIMXMM', 'Z_CARACT_MISENCONT': 'ATS_MISENCONT', 'Z_CARACT_CAPACITEL': 'ATS_CAPACITEL', 'Z_CARACT_CLADIMED': 'ATS_CLASSIFICATIONCLADIMED', 'Z_CARACT_NBREROULCART': 'ATS_NBREROULCART', 'Z_CARACT_PROFBACMM': 'ATS_PROFBAC_UM', 'Z_CARACT_PUISHTPARLINTW': 'ATS_PUISHTPARLINTW', 'Z_CARACT_PLAFMOBIL': 'ATS_PLAFMOBIL_LOV', 'Z_CARACT_PORTEEINT_UM_METRE': 'ATS_PORTEEINT_UM', 'Z_CARACT_LXHXPRUTILEMM': 'ATS_LXHXPRUTILEMM', 'Z_CARACT_SYSTSUP': 'ATS_SYSTSUP', 'Z_CARACT_ECEXFOURCHMM': 'ATS_ECEXFOURCHMM', 'Z_CARACT_CHGTPAPIER': 'ATS_CHGTPAPIER', 'Z_CARACT_CHFEUILLES': 'ATS_CHARGEFEUILLES', 'SAE_VL_MODELE': 'ATS_MODELE_VEHICULE_LOV', 'Z_CARACT_PUISSANCEPOE_UM_WATT': 'ATS_PUISSANCEPOE_UM', 'Z_CARACT_RACKABLE': 'ATS_RACKABLE_LOV', 'Z_CARACT_MAJCARTOG': 'ATS_MAJCARTOG', 'Z_CARACT_RESONATPPP': 'ATS_RESONATPPP', 'Z_CARACT_COLCUVCOUV': 'ATS_COLORISCUVCOUV', 'Z_CARACT_NORMBACNF1276': 'ATS_NORMBACNF1276', 'Z_CARACT_PLATEAULXLCM': 'ATS_PLATEAULXLCM', 'Z_CARACT_MATIERE': 'ATS_MATIERE', 'Z_CARACT_LONGCABLECM': 'ATS_LONGUEURCABLE_UM', 'Z_CARACT_GRIP': 'ATS_GRIP', 'Z_CARACT_COMPDOUBLU': 'ATS_COMPOSITIONDOUBLURE', 'Z_CARACT_TLCPMEMP': 'ATS_TLCPMEMP', 'Z_CARACT_MATRIOBOUCHON': 'ATS_MATRIOBOUCHON', 'Z_CARACT_TYPSYSTMLIAISO': 'ATS_TYPSYSTMLIAISO', 'Z_CARACT_NOMBREDESAC': 'ATS_NOMBREDESAC', 'Z_CARACT_SYSEXPLOIT': 'ATS_SYSEXPLOIT', 'Z_CARACT_DEBITLM': 'ATS_DEBITLM', 'Z_CARACT_RESOLPPP': 'ATS_RESOLPPP', 'Z_CARACT_TYPMODULE': 'ATS_TYPMODULE', 'Z_CARACT_TYPEDEVISIRE': 'ATS_TYPEDEVISIRE', 'Z_CARACT_INDICEPROTECTIONIP': 'ATS_INDICEPROTECTIONIP', 'Z_CARACT_NIVSONORNECOPLDB': 'ATS_NIVSONORNECOPLDB', 'Z_CARACT_OBJECTIF': 'ATS_OBJECTIF', 'SAE_VL_CO2_MAX': 'ATS_WLTP_CO2_MAX', 'SAE_VL_PUISSANCE': 'ATS_PUISSANCE_CH_VEHICULE', 'Z_CARACT_MOTRICITE': 'ATS_MOTRICITE', 'Z_CARACT_EPAISMICM': 'ATS_EPAISMICM', 'Z_CARACT_MATCUVE': 'ATS_MATERIAUCUVE', 'Z_CARACT_DOMAINUTILISATIO': 'ATS_DOMAINUTILISATIO', 'Z_CARACT_NBPORTSENTDCM': 'ATS_NBPORTSENTDCM', 'Z_CARACT_DIMVEHICULLXLXHM': 'ATS_DIMVEHICULELXLXHM', 'Z_CARACT_NOMBREVUES': 'ATS_NOMBREVUES', 'Z_CARACT_MATERIAUPOC': 'ATS_MATERIAUPOC', 'Z_CARACT_NUMERORDRE': 'ATS_NUMERORDRE', 'Z_CARACT_BONUSECOLO': 'ATS_BONUSECOLO_LOV', 'Z_CARACT_CLASSEENELUM': 'ATS_CLASSEENELUM', 'Z_CARACT_RESOLUNAT': 'ATS_RESOLUNAT', 'Z_CARACT_SUPPORTDETRUIT': 'ATS_SUPPORTDETRUIT', 'Z_CARACT_LXHXPRUTILECM': 'ATS_LXHXPRUTILECM', 'Z_CARACT_ALTITUDEMAX_UM_METRE': 'ATS_ALTITUDEMAX_UM', 'Z_CARACT_LAIMPMIMAXMM': 'ATS_LAIMPMIMAXMM', 'Z_CARACT_VIMPATN_UM_PAGEPARMINUTE': 'ATS_VIMPATN_UM', 'Z_CARACT_TYPECRAN': 'ATS_TYPECRAN', 'Z_CARACT_LONGCABLEM': 'ATS_LONGCABLEM', 'Z_CARACT_TYPEPROD': 'ATS_TYPE_PRODUIT', 'SAE_VL_CO2_NORME_TEST': 'ATS_WLTP_CO2_NORME_TEST', 'Z_CARACT_TAILLEROUES': 'ATS_TAILLEROUES', 'Z_CARACT_VITDEPASCHKMH': 'ATS_VITDEPASCH_UM', 'Z_CARACT_CPLAUTILCM': 'ATS_CPLAUTILCM', 'Z_CARACT_TYPNUM': 'ATS_TYPNUM', 'Z_CARACT_ASSISEREGLABLE': 'ATS_ASSISEREGLABLE', 'Z_CARACT_TRAITOCULAIRE': 'ATS_TRAITOCULAIRE', 'Z_CARACT_FINITIONSTRUC': 'ATS_FINITIONSTRUC', 'Z_CARACT_POIDSMAXIENPLATEFORME': 'ATS_POIDMAXPLATEFORMEKG', 'Z_CARACT_VITCOPIMPCA3_PPM': 'ATS_VITCOPIMPCA3PPM', 'Z_CARACT_MATCARTER': 'ATS_MATCARTER', 'Z_CARACT_MODEFINANCE': 'ATS_MODEFINANCE', 'Z_CARACT_PANNEAU': 'ATS_PANNEAU', 'Z_CARACT_HAUTNBU': 'ATS_HAUTNBU', 'Z_CARACT_SUPPORTCHAUSSURE': 'ATS_SUPPORTCHAUSSURE', 'Z_CARACT_MATPOTEAU': 'ATS_MATPOTEAU', 'Z_CARACT_VITESSAIRKMH': 'ATS_VITESSAIRKMH', 'Z_CARACT_FACTFORME': 'ATS_FACTFORME', 'Z_CARACT_INCLINABLE': 'ATS_INCLINABLE_LOV', 'Z_CARACT_POIDSSPIEDKG': 'ATS_POIDSSPIED_UM', 'Z_CARACT_NBPROCES': 'ATS_NBPROCES', 'Z_CARACT_ENTRAXE_UM_CM': 'ATS_ENTRAXECM', 'Z_CARACT_VIDISCDURTPM': 'ATS_VIDISCDURTPM', 'Z_CARACT_TYPENIVEAU': 'ATS_TYPENIVEAU', 'Z_CARACT_ANIMALFREE': 'ATS_ANIMALFREE', 'Z_CARACT_LARGEURTRAIT': 'ATS_LARGEURTRAITMM', 'Z_CARACT_PRECISIONDEGC': 'ATS_PRECISIONDEGC', 'Z_CARACT_VERINREGLE': 'ATS_VERINREGLE_LOV', 'Z_CARACT_TYPCONECT': 'ATS_TYPCONECT', 'Z_CARACT_COMPATIBPC': 'ATS_COMPATIBLEPC_LOV', 'Z_CARACT_LARGCOUPCM': 'ATS_LARGCOUPCM', 'Z_CARACT_CUVELXHXPRCM': 'ATS_CUVELXHXPRCM', 'Z_CARACT_MULTIFCTN': 'ATS_MULTIFCTN_LOV', 'Z_CARACT_VIMPAQNPPM': 'ATS_VIMPAQNPPM', 'Z_CARACT_MATERIAUPLATEAU': 'ATS_MATERIAUPLATEAU', 'Z_CARACT_BIODEGRADABL': 'ATS_BIODEGRADABL', 'Z_CARACT_COMPATIBLE': 'ATS_COMPATIBLE', 'Z_CARACT_TYPMILIEU': 'ATS_TYPMILIEU', 'Z_CARACT_KEYSTONHVD': 'ATS_KEYSTONHVD', 'Z_CARACT_NORMFONNF1650': 'ATS_NORMFONNF1650', 'Z_CARACT_FINITIONCHAS': 'ATS_FINITIONCHAS', 'Z_CARACT_MODNUM': 'ATS_MODNUM', 'Z_CARACT_FERMETURACLE': 'ATS_FERMETURACLE', 'Z_CARACT_AUTREQTESPOSSIBLES': 'ATS_AUTREQTESPOSSIBLES', 'Z_CARACT_TYPBOITIER': 'ATS_TYPBOITIER', 'SAE_VL_ROUE_MOTRICE': 'ATS_TYPE_ROUE_MOTRICE', 'SAE_VL_PARA_IMMAT': 'ATS_PARA_IMMAT_LOV', 'Z_CARACT_DIMENSIONLPHEXTMM': 'ATS_DIMENSIONSEXTLXHXPR', 'Z_CARACT_MAINTENANCE': 'ATS_MAINTENANCE', 'Balise Metadescription SEO du site Ugap.fr': 'ATS_METADESCRIPTION_SEO', 'Z_CARACT_LAMREVERDEMON': 'ATS_LAMREVERDEMON_LOV', 'Z_CARACT_RESOLUTPIXEL': 'ATS_RESOLUTPX', 'Z_CARACT_NBRETIROIR': 'ATS_NBRETIROIR', 'Z_CARACT_FENETREOUINON': 'ATS_FENETREOUINON', 'Z_CARACT_TYPECHELLE': 'ATS_TYPECHELLE', 'Z_CARACT_TYPROTECT': 'ATS_TYPROTECTION', 'Z_CARACT_LIMITDETECTIONPPB': 'ATS_LIMITDETECTIONPPB', 'Z_CARACT_ENVELOPPE': 'ATS_ENVELOPPE', 'Z_CARACT_ENREGH': 'ATS_ENREGH', 'Z_CARACT_TYPECLAIRAGE': 'ATS_TYPECLAIRAGE', 'Z_CARACT_ENCLXHXPRCM': 'ATS_ENCLXHXPRCM', 'Z_CARACT_NBRESLOTDISPO': 'ATS_NBRESLOTDISPO', 'Z_CARACT_MATSTRUCTURE': 'ATS_MATSTRUCTURE', 'Z_CARACT_HHORSTOUTMIMAXMM': 'ATS_HHORSTOUTMIMAXMM', 'Z_CARACT_NBBALAD': 'ATS_NBBALAD', 'Z_CARACT_INSONOTEAU': 'ATS_INSONOTEAU_LOV', 'Z_CARACT_CAPPERFEUIL': 'ATS_CAPPERFEUIL', 'Z_CARACT_SPALIM': 'ATS_SPALIM', 'Z_CARACT_NBPORT': 'ATS_NBPORT', 'SAE_VL_CV_FISCAUX': 'ATS_PUISSANCE_CV_VEHICULE', 'Z_CARACT_NBRECARTON': 'ATS_NBRECARTON', 'Z_CARACT_NBREETAGERE': 'ATS_NBREETAGERE', 'Z_CARACT_EMBOITABLE': 'ATS_EMBOITABLE', 'Z_CARACT_HTPLIELXHXPRCM': 'ATS_HTPLIELXHXPRCM', 'Z_CARACT_INDICSURCHAUF': 'ATS_INDICSURCHAUF', 'Z_CARACT_GRAMMAGEGMC': 'ATS_GRAMMAGEGMC', 'Z_CARACT_CAPMAXITO': 'ATS_CAPMAXITO', 'Z_CARACT_ETANCHITELIQUIDES': 'ATS_ETANCHITELIQUIDES_LOV', 'Z_CARACT_TYPBOISSEAU': 'ATS_TYPBOISSEAU', 'Z_CARACT_NBANTEN': 'ATS_NBANTEN', 'Z_CARACT_COMPARTLXLXHCM': 'ATS_COMPARTLXLXHCM', 'Z_CARACT_DETECLUMIN': 'ATS_DETECLUMIN_LOV', 'Z_CARACT_NOMBRERABATS': 'ATS_NOMBRERABATS', 'Z_CARACT_POSITIONBAC': 'ATS_POSITIONBAC', 'Z_CARACT_INDICAFFAIBLTDB': 'ATS_INDICAFFAIBLTDB', 'Z_CARACT_RESOCAPTEURAV_UM_MEGAPIXEL': 'ATS_RESOCAPTEURAV_UM', 'Z_CARACT_LARGEUR_UM_METRE': 'ATS_LARGEUR_UM', 'Z_CARACT_PROTECTNASALE': 'ATS_PROTECTNASALE', 'Z_CARACT_NIVSECUDIN': 'ATS_NIVSECUDIN', 'W_BIOMED_HAUTEUR': 'ATS_HAUTEUR', 'Z_CARACT_INTERFETHER': 'ATS_INTERFETHER_LOV', 'Z_CARACT_SCURIT': 'ATS_SECURTE', 'Z_CARACT_CAPFUTL': 'ATS_CAPFUTL', 'Z_CARACT_IMPSECUR': 'ATS_IMPSECUR_LOV', 'Z_CARACT_MATFIXATION': 'ATS_MATFIXATION', 'Z_CARACT_TENSBASCULREGLA': 'ATS_TENSBASCULREGLA_LOV', 'Z_CARACT_ENTREJAMBECM': 'ATS_ENTREJAMBECM', 'Z_CARACT_COQUE': 'ATS_COQUE', 'Z_CARACT_REFLAMPE': 'ATS_REFLAMPE', 'Z_CARACT_EMBOUTSANTIDERAP': 'ATS_EMBOUTSANTIDERAP_LOV', 'Z_CARACT_MASSEVOLUMIQUE': 'ATS_MASSEVOLUMIQUE', 'Z_CARACT_ECRANHTCM': 'ATS_ECRANHTCM', 'Z_CARACT_COMPATIBLEFULL3D': 'ATS_COMPATIBLEFULL3D_LOV', 'Z_CARACT_AMORTISTIROIR': 'ATS_AMORTISSEURFERMTIROIR_LOV', 'Z_CARACT_NBPORTSDC': 'ATS_NBPORTSDC', 'Z_CARACT_POIDSSUBSTANCG': 'ATS_POIDSSUBSTANCG', 'Z_CARACT_HAUTSAUTMAX': 'ATS_HAUTSAUTMAX', 'Z_CARACT_PLIELXHXPRMM': 'ATS_PLIELXHXPRMM', 'Z_CARACT_ECRANDISPO': 'ATS_ECRANDISPO_LOV', 'Z_CARACT_FACADEAVT': 'ATS_FACADEAVT', 'Z_CARACT_COMPATIBMAC': 'ATS_COMPATIBLEMAC_LOV', 'Z_CARACT_MODSORTAUDIO': 'ATS_MODSORTAUDIO', 'Z_CARACT_ORBITE': 'ATS_ORBITE', 'Z_CARACT_BAIESEXTENSIO': 'ATS_BAIE_EXTENSION', 'Z_CARACT_TYPROUFOURCH': 'ATS_TYPROUFOURCH', 'Z_CARACT_BACENTREE': 'ATS_BACENTREE_LOV', 'Z_CARACT_COQUILANTIBRUI': 'ATS_COQUILANTIBRUI_LOV', 'Z_CARACT_DETECTPRES': 'ATS_DETECTPRES_LOV', 'Z_CARACT_TELINTEGRE': 'ATS_TELINTEGRE_LOV', 'Z_CARACT_NBPISTON': 'ATS_NBPISTON', 'W_BIOMED_GRADE': 'ATS_BIOMED_GRADE', 'Z_CARACT_ANGLEHAUTEURDATTEINTEM_UM_DEGRE': 'ATS_ANGLEHAUTEURATTEINTE_UM', 'Z_CARACT_NBCASIER': 'ATS_NBCASIER', 'Z_CARACT_MATERDOSSIER': 'ATS_MATERDOSSIER', 'Z_CARACT_NBPORTSENTDC': 'ATS_NBPORTSENTDC', 'Z_CARACT_VENTPAR': 'ATS_VENDUPAR', 'Z_CARACT_NBREDEPLACES': 'ATS_NBREDEPLACES', 'Z_CARACT_INTERFACE': 'ATS_INTERFACES', 'Z_CARACT_RECHARGEABLE': 'ATS_RECHARGEABLE_LOV', 'SAE_VL_ID_JATO': 'ATS_ID_JATO', 'Z_CARACT_NBACCESPASSAG': 'ATS_NBACCESPASSAG', 'Z_CARACT_PLATEAULXPRCM': 'ATS_PLATEAULXPRCM', 'Z_CARACT_CONSOW': 'ATS_CONSOW', 'Z_CARACT_MATRIAUBRANCH': 'ATS_MATRIAUBRANCH', 'Z_CARACT_CAPMOYNBPJ': 'ATS_CAPACITEMOYNBPJ', 'Z_CARACT_NBROUES': 'ATS_NBROUES', 'Z_CARACT_HAUTABLIE_UM_MILLIMETRE': 'ATS_HAUTABLIE_UM', 'Z_CARACT_INTERFUSB': 'ATS_INTERFUSB_LOV', 'Z_CARACT_MANCHES': 'ATS_MANCHES', 'Z_CARACT_MEMOIRECACHEMO': 'ATS_MEMOIRECACHEMO', 'Z_CARACT_NBCOULEUR': 'ATS_NBCOULEUR', 'Z_CARACT_HAUTREGLABLECM': 'ATS_HAUTREGLABLECM', 'Z_CARACT_CASIERLXLCM': 'ATS_CASIERLXLCM', 'SAE_VL_C02_MIN': 'ATS_WLTP_CO2_MIN', 'Z_CARACT_CAPACITETRACTION': 'ATS_CAPACITETRACTION_UM', 'Z_CARACT_DENSASSISKGMCU': 'ATS_DENSASSISKGMCU', 'Z_CARACT_VITIMPR_UM_MMPARSECONDE': 'ATS_VITIMPR_UM', 'Z_CARACT_FORMRGVIDEO': 'ATS_FORMRGVIDEO', 'Z_CARACT_TYPVERROUIL': 'ATS_TYPVERROUIL', 'Z_CARACT_VITIMPRC_UM_CARACTERPARSECONDE': 'ATS_VITIMPRC_UM', 'Z_CARACT_DIAMXLMM': 'ATS_DIAMXLMM', 'Z_CARACT_ENERGYSTAR': 'ATS_ENERGYSTAR_LOV', 'Z_CARACT_INTERFACEAV': 'ATS_INTERFACEAV', 'Z_CARACT_BOUTDIAMX_UM_MILLIMETRE': 'ATS_DIAMMAXIBOUTEILLE_UM', 'Z_CARACT_PUISSCHASSIS_UM_CHEVALFISCAL': 'ATS_PUISSCHASSIS_UM', 'Z_CARACT_TECHNECRAN': 'ATS_TECHNECRAN', 'Z_CARACT_INTERFACEAR': 'ATS_INTERFACEAR', 'Z_CARACT_PROTGENUQ': 'ATS_PROTGENUQ_LOV', 'Z_CARACT_CARTOGDEBASE': 'ATS_CARTOGDEBASE', 'Z_CARACT_COLORPLATEAU': 'ATS_COLORISPLATEAU', 'Z_CARACT_NBREMARCHE': 'ATS_NBREMARCHE', 'Z_CARACT_MEMOIREVIDEO': 'ATS_MEMOIREVIDEO', 'Z_CARACT_POIGNET': 'ATS_POIGNET', 'Z_CARACT_EMPILABLE': 'ATS_EMPILABLE', 'Z_CARACT_REFFAB': 'ATS_REFFAB', 'Z_CARACT_TYPANCRAG': 'ATS_TYPANCRAG', 'Z_CARACT_RENDLUMINLMW': 'ATS_RENDLUMINLMW', 'Z_CARACT_PTEDIAMM': 'ATS_PTEDIAMM', 'Z_CARACT_CONTREMP': 'ATS_CONTROLTEMP', 'Z_CARACT_LECTCARTMEM': 'ATS_LECTCARTMEM', 'Z_CARACT_RESOCAPTEURAR_UM_MEGAPIXEL': 'ATS_RESOCAPTEURAR_UM', 'Z_CARACT_TYPALIM': 'ATS_TYPALIM', 'Z_CARACT_MATPHONIQ': 'ATS_MATPHONIQ', 'Z_CARACT_CAPTEUR': 'ATS_CAPTEUR', 'Z_CARACT_POUSTALON': 'ATS_POUSTALON_LOV', 'Z_CARACT_LARGEURECHELON_UM_MILLIMETRE': 'ATS_LARGEURECHELON_UM', 'Z_CARACT_EPAISTIGEMM': 'ATS_EPAISTIGEMM', 'Z_CARACT_ASSEMBLABLE': 'ATS_ASSEMBLABLE_LOV', 'Z_CARACT_EFFACABLE': 'ATS_EFFACABLE_LOV', 'Z_CARACT_NBOUTILRAC': 'ATS_NBOUTILRAC', 'Z_CARACT_EMPREINTELXLMM': 'ATS_EMPREINTELXLMM', 'Z_CARACT_BANDNOTACH': 'ATS_BANDAGENONTACHANT_LOV', 'LIGNE_PRODUIT': 'ATS_GENRE_VEHICULE_LOV', 'Z_CARACT_COMPATIBLEPOMP': 'ATS_COMPATIBLEPOMP', 'Z_CARACT_CATEGORIE': 'ATS_CATEGORIE', 'Z_CARACT_AUTONOMIEMIN': 'ATS_AUTONOMIEMIN', 'Z_CARACT_COLORISCOFFRE': 'ATS_COLORISCOFFRE', 'Z_CARACT_DEBITAIRMCH': 'ATS_DEBITAIRMCH', 'Z_CARACT_RESOCAPTEUR_UM_MEGAPIXEL': 'ATS_RESOCAPTEUR_UM', 'Z_CARACT_GLANDS': 'ATS_GLANDS', 'Z_CARACT_TYPAMBUL': 'ATS_TYPAMBUL', 'Z_CARACT_MATIERCOUV': 'ATS_MATIERCOUV', 'Z_CARACT_REFUNIPROT': 'ATS_REFUNIPROT', 'Z_CARACT_RECTOVERSO': 'ATS_RECTOVERSO_LOV', 'Z_CARACT_REDUCNIVOSONOREDB': 'ATS_REDUCNIVOSONOREDB', 'Z_CARACT_QUALITE': 'ATS_QUALITE', 'Z_CARACT_FACADEARR': 'ATS_FACADEARR', 'Z_CARACT_TYPTABLE': 'ATS_TYPTABLE', 'Z_CARACT_ECRANTORIENTBL': 'ATS_ECRANTORIENTBL_LOV', 'Z_CARACT_MATRIOSEMELEXT': 'ATS_MATRIOSEMELEXT', 'Z_CARACT_TAILLECRANMAXP': 'ATS_TAILLECRANMAXP', 'Z_CARACT_ISO9706': 'ATS_ISO9706_LOV', 'Z_CARACT_ELECTRIQUE': 'ATS_ELECTRIQUE_LOV', 'Z_CARACT_EMBOUTSECU': 'ATS_EMBOUTSECU_LOV', 'Z_CARACT_LUMILUM': 'ATS_LUMILUMLM', 'Z_CARACT_UTILCONSEILLE': 'ATS_UTILCONSEILLE', 'Z_CARACT_LONGCORDM': 'ATS_LONGCORDM', 'Z_CARACT_DIAMASSISECM': 'ATS_DIAMASSISE_UM', 'Z_CARACT_RSOLVP': 'ATS_RSOLVP', 'Z_CARACT_SENSIBILITE_UM_LUX': 'ATS_SENSIBILITE_UM', 'Z_CARACT_PORTEEM': 'ATS_PORTEEM', 'Z_CARACT_CTRLGRAPH': 'ATS_CTRLGRAPH', 'Z_CARACT_PUISSEMIS_UM_WATT': 'ATS_PUISSEMISSIONW', 'Z_CARACT_PRTAMPONREF': 'ATS_PRTAMPONREF', 'Z_CARACT_INTMANUELF': 'ATS_INTMANUELF', 'Z_CARACT_PERIODE': 'ATS_PERIODE', 'SAE_VL_NOMBRE_VITESSES': 'ATS_NOMBRE_VITESSE_VEHICULE', 'Z_CARACT_TYPEDCRANTACTIL': 'ATS_TYPEDCRANTACTIL', 'Z_CARACT_MASSEMAXDECOLLAGE': 'ATS_MASSEMAXDECOLLAGE', 'Z_CARACT_ARCPOREPLI': 'ATS_ARCEAUPOUSSEEREPLIABLE_LOV', 'Z_CARACT_NBTOUCHE': 'ATS_NBTOUCHE', 'Z_CARACT_TYPMONITEUR': 'ATS_TYPMONITEUR', 'Z_CARACT_MATERFACAD': 'ATS_MATFACADE', 'Z_CARACT_TEMPSLATENCE': 'ATS_TEMPSLATENCE', 'Z_CARACT_INCLINAISONECRDEG': 'ATS_INCLINAISONECRDEG', 'Z_CARACT_VITESSECOUPE_UM_MMPARSECONDE': 'ATS_VITESSECOUPE.UM', 'Z_CARACT_ARTICULE': 'ATS_ARTICULE_LOV', 'Z_CARACT_PLATEARABATABLE': 'ATS_PLATEARABATABLE_LOV', 'Z_CARACT_INTERFACESBUS': 'ATS_INTERFACESBUS', 'Z_CARACT_AUTRNORM': 'ATS_AUTRENORME', 'Z_CARACT_PASMICRONDE': 'ATS_PASMICRONDE_LOV', 'Z_CARACT_EPCHANTMM': 'ATS_EPCHANTMM', 'Z_CARACT_DUREVILAMPH': 'ATS_DUREVILAMP.UM', 'Z_CARACT_RETRACTABLE': 'ATS_RETRACTABLE_LOV', 'Z_CARACT_VITESSEAIR': 'ATS_VITESSEAIR_UM', 'Z_CARACT_VITESOBTURS': 'ATS_VITESOBTURS', 'Z_CARACT_TYPEDEBAVETTE': 'ATS_TYPEDEBAVETTE', 'Z_CARACT_CROISILLON': 'ATS_CROISILLON_LOV', 'Z_CARACT_MULTICOPIE': 'ATS_MULTICOPIE_LOV', 'Z_CARACT_TYPEDLMENT': 'ATS_TYPEDLMENT', 'Z_CARACT_LANGUETMATEL': 'ATS_LANGUETMATEL', 'Z_CARACT_HTLXLMM': 'ATS_HTLXLMM', 'Z_CARACT_NBPTSCELEMENT': 'ATS_NBPTSCELEMENT', 'Z_CARACT_ASSISE': 'ATS_ASSISE', 'Z_CARACT_PACTECAPACITAIRE': 'ATS_PACTECAPACITAIRE', 'Z_CARACT_CULOT': 'ATS_CULOT', 'Z_CARACT_TYPEVIDAGE': 'ATS_TYPEVIDAGE', 'Z_CARACT_MODERAFALE': 'ATS_MODERAFALE', 'Z_CARACT_ROUFOURDIALMM': 'ATS_ROUFOURDIALMM', 'Z_CARACT_MATRIOANTIPERFO': 'ATS_MATRIOANTIPERFO', 'Z_CARACT_TYPEREMORQUE': 'ATS_TYPEREMORQUE', 'Z_CARACT_TYPRANGEMENT': 'ATS_TYPRANGEMENT', 'Z_CARACT_MARQUE': 'ATS_MARQUE', 'Z_CARACT_LARGEURM ; Z_CARACT_LARGMM ; Z_CARACT_LARGEURCM': 'ATS_LARGEUR', 'Z_CARACT_NBREROULETTE': 'ATS_NBREROULETTES', 'Z_CARACT_VOLUME': 'ATS_VOLUME_UM', 'Z_CARACT_GRAVEUR': 'ATS_GRAVEUR', 'ED_MOTS_CLES_MULTIEDITEURS': 'ATS_ED_MOTS_CLES_MULTIEDITEURS', 'Z_CARACT_BALAYAGE': 'ATS_BALAYAGE', 'Z_CARACT_TETELXLCM': 'ATS_TETELXLCM', 'Z_CARACT_LIMITUTILISATION': 'ATS_LIMITUTILISATION', 'Z_CARACT_LONGSONDECM': 'ATS_LONGSONDE_UM', 'Z_CARACT_MARQVIDEOPRO': 'ATS_MARQVIDEOPRO', 'SAE_VL_FINITION': 'ATS_FINITION_VEHICULE', 'Z_CARACT_MATPORTEARR': 'ATS_MATPORTEARR', 'Z_CARACT_NBBOITEH': 'ATS_NBBOITEH', 'Z_CARACT_VITESSROTATRMIN': 'ATS_VITESSROTATRMIN', 'Z_CARACT_VITCOPIMPA3_UM_PAGEPARMINUTE': 'ATS_VITCOPIMPA3PPM', 'Z_CARACT_POIDSKG': 'ATS_POIDS_UM', 'Z_CARACT_GARANTILAMP': 'ATS_GARANTILAMP', 'Z_CARACT_GAMME': 'ATS_GAMME', 'Z_CARACT_PORTEEEXT_UM_METRE': 'ATS_PORTEEEXT_UM', 'Z_CARACT_TYPOUVERT': 'ATS_TYPOUVERT', 'Z_CARACT_SUPMULTIRO': 'ATS_SUPMULTIRO', 'Z_CARACT_FABPAPIER': 'ATS_FABPAPIER', 'Z_CARACT_POCHESCT': 'ATS_POCHESCT', 'Z_CARACT_MOTORISATION': 'ATS_MOTORISATION', 'Z_CARACT_VOLMAXMOIP': 'ATS_VOLMAXMOIP', 'Z_CARACT_VITELEV_UM_MMPARSECONDE': 'ATS_VITELEV_UM', 'Z_CARACT_BLCPTELXHXPRUTMM': 'ATS_BLCPTELXHXPRUTMM', 'Z_CARACT_TYPECRANPROJ': 'ATS_TYPECRANPROJ', 'Z_CARACT_TYPEPORTE': 'ATS_TYPEPORTE', 'Z_CARACT_FOURNISSEUR': 'ATS_FOURNISSEUR', 'Z_CARACT_DUREVIMOYH': 'ATS_DUREVIMOYH', 'Z_CARACT_RELIURE': 'ATS_RELIURE', 'Z_CARACT_LONGUEURM': 'ATS_LONGUEURM', 'Z_CARACT_POSITIONCONDUC': 'ATS_POSITIONCONDUC', 'Z_CARACT_COMPATIBLLAVAGEIND': 'ATS_COMPATIBLELAVAGEIND', 'Z_CARACT_EPAIDOSMM': 'ATS_EPAIDOSMM', 'Z_CARACT_REFCONSTRUCT': 'ATS_REFCONSTRUCT', 'Z_CARACT_POIGNEEPREHEN': 'ATS_POIGNPREHENS_LOV', 'Z_CARACT_CHARGESTMAX_unece_unit_KGM': 'ATS_CHARGESTMAX_UM', 'Z_CARACT_CAPNBTABLETTE': 'ATS_CAPACITENBTABLETTE', 'Z_CARACT_TYPGAINE': 'ATS_TYPGAINE', 'Z_CARACT_INTERFSCSI': 'ATS_INTERFSCSI_LOV', 'Z_CARACT_POIDS': 'ATS_POIDS', 'Z_CARACT_MARQUECHASSIS': 'ATS_MARQUECHASSIS', 'Z_CARACT_PILNORM': 'ATS_PILNORM', 'Z_CARACT_INTERUPTEUR': 'ATS_INTERRUPTEUR', 'Z_CARACT_REFFOUR': 'ATS_REFFOUR', 'Z_CARACT_PLAGEREGLMM': 'ATS_PLAGEREGLMM', 'Z_CARACT_PROFONDEURMAXM': 'ATS_PROFONDEURMAX_UM', 'Z_CARACT_TEMPSECHS': 'ATS_TEMPSECHS', 'Z_CARACT_PASLAVEVAISSELLE': 'ATS_PASLAVEVAISSELLE', 'Z_CARACT_MATRIOARCEAU': 'ATS_MATRIOARCEAU', 'Z_CARACT_CAPRESERVL': 'ATS_CAPRESERVL', 'SAE_VL_WLTP_EMISSION_PARTICULE': 'ATS_WLTP_EMISSION_PARTICULE', 'Z_CARACT_TYPEAMPOULE': 'ATS_TYPEAMPOULE', 'Z_CARACT_COMPATLOG': 'ATS_COMPATIBILITELOG', 'Z_CARACT_SOUTIPOUSSIE': 'ATS_SOUTIPOUSSIE_LOV', 'Z_CARACT_PUISSANCEKW': 'ATS_PUISSANCEKW', 'Z_CARACT_CANONTOIT': 'ATS_CANONTOIT_LOV', 'Z_CARACT_REGLURE': 'ATS_REGLURE', 'Z_CARACT_STOCBREFRD': 'ATS_STOCBREFRD_LOV', 'Z_CARACT_FOCALE': 'ATS_FOCALE', 'Z_CARACT_LONGCORDELETM': 'ATS_LONGCORDELETM', 'Z_CARACT_LOIMPMIMAXMM': 'ATS_LOIMPMIMAXMM', 'Z_CARACT_TUYDIAM_UM_MILLIMETRE': 'ATS_DIAMTUYEAU_UM', 'Z_CARACT_MATMEMEBRAN': 'ATS_MATMEMEBRAN', 'Z_CARACT_NBNUMBREG': 'ATS_NBNUMBREG', 'SAE_VL_INTERFACE_SMARTPHONE': 'ATS_INTERFACE_SMARTPHONE', 'Z_CARACT_PREMDEPROPRETE': 'ATS_PREMDEPROPRETE', 'Z_CARACT_LONGSANGLE_UM_METRE': 'ATS_LONGSANGLE_UM', 'Z_CARACT_HSPLATEAUCM': 'ATS_HSPLATEAUCM', 'SAE_VL_VERSION_VEHICULE': 'ATS_VERSION_VEHICULE', 'Z_CARACT_INCLINPLATEAUD': 'ATS_INCLINPLATEAUD', 'Z_CARACT_MATRIOCOUSINE': 'ATS_MATRIOCOUSINE', 'Z_CARACT_TYPFUT': 'ATS_TYPFUT', 'Z_CARACT_REFLECTRLXLMM': 'ATS_REFLCTRLXLMM', 'Z_CARACT_TYPSERRURE': 'ATS_TYPSERRURE', 'Z_CARACT_NBPERSENPLATEFORME': 'ATS_NBPERSENPLATEFORME', 'Z_CARACT_PLATEFORMEDIAM_UM_MILLIMETRE': 'ATS_DIAMPLATEFORME.UM', 'Z_CARACT_HAUTEUR_UM': 'ATS_HAUTEUR_UM', 'Z_CARACT_ROUDIDIALMM': 'ATS_ROUDIDIALMM', 'Z_CARACT_FERMPORTES': 'ATS_FERMPORTES', 'Z_CARACT_PEFC': 'ATS_PEFC', 'Z_CARACT_MODULQATG': 'ATS_MODULQATG', 'Z_CARACT_NORMECLAVIER': 'ATS_NORMECLAVIER', 'Z_CARACT_CAPACITE': 'ATS_CAPACITESSUNITE', 'Z_CARACT_APPUIETETE': 'ATS_APPUIETETE', 'Z_CARACT_DIATUBEMM': 'ATS_DIATUBEMM', 'Z_CARACT_PANNEAUPMV': 'ATS_PANNEAUPMV_LOV', 'Z_CARACT_STYLET': 'ATS_STYLET', 'SAE_VL_REGULATEUR_VITESSE': 'ATS_REGULATEUR_VITESSE', 'Z_CARACT_POIDSAVPIEDKG': 'ATS_POIDSAVPIED_UM', 'Z_CARACT_CSLAUTILCM': 'ATS_CSLAUTILCM', 'Z_CARACT_CAPDISCDUR': 'ATS_CAPACITEDISCDUR', 'Z_CARACT_FIXATIONDESSACS': 'ATS_FIXATIONDESSACS', 'Z_CARACT_PREHENS': 'ATS_PREHENS', 'Z_CARACT_ANGVUENHVD': 'ATS_ANGVUENHVD', 'SAE_VL_SI_NAVIGATION': 'ATS_SI_NAVIGATION', 'Z_CARACT_RESOLSCANDPI': 'ATS_RESOLSCANPPP', 'Z_CARACT_FOYERTYPE': 'ATS_FOYERTYPE', 'Z_CARACT_FORME': 'ATS_FORME', 'Z_CARACT_LANCRAGM': 'ATS_LANCRAGM', 'Z_CARACT_FORMATLLCM': 'ATS_FORMATLLCM', 'Z_CARACT_HTPLIELXLCM': 'ATS_HTPLIELXLCM', 'Z_CARACT_NUMDIAPO': 'ATS_NUMDIAPO_LOV', 'Z_CARACT_FORMEBOUCHON': 'ATS_FORMEBOUCHON', 'Z_CARACT_DEBIRESELECT_UM_MEGABITPARSECONDE': 'ATS_DEBITRESELECT_UM', 'Z_CARACT_MODSUPSAUV': 'ATS_MODSUPSAUV', 'Z_CARACT_RSISTRUPTBOUCLKN': 'ATS_RSISTRUPTBOUCLKN', 'Z_CARACT_INDICEPOMPELBAR': 'ATS_INDICEPOMPELBAR', 'Z_CARACT_TAILLECRANPORTP': 'ATS_TAILLECRANPORT', 'Z_CARACT_VITESSEKMH': 'ATS_VITESSEKMH', 'Z_CARACT_BACOLLECT': 'ATS_BACCOLLECTEUR_LOV', 'Z_CARACT_NCBI': 'ATS_NCBI', 'Z_CARACT_TAILLECRANCM': 'ATS_TAILLECRANCM', 'Z_CARACT_AUTONOMIEH': 'ATS_AUTONOMIEH', 'Z_CARACT_REVETEMENT': 'ATS_REVETEMENT', 'Z_CARACT_MINICOMMAND': 'ATS_MINICOMMAND', 'Z_CARACT_ECRANPLIELXHXPRCM': 'ATS_ECRANPLIELXHXPRCM', 'Z_CARACT_CAPRESERVHUILE_UM_LITRE': 'ATS_CAPACITERESERVHUILE_UM', 'Z_CARACT_TYPALLUM': 'ATS_TYPALLUM', 'Z_CARACT_MATOITURE': 'ATS_MATOITURE', 'Z_CARACT_LARGETIQMAX_UM_MILLIMETRE': 'ATS_LARGETIQMAX_UM', 'Z_CARACT_CONSOMMATIONKWH': 'ATS_CONSOMMATIONKWH', 'Z_CARACT_HTAVPIEDLXHXPRCM': 'ATS_HTAVPIEDLXHXPRCM', 'Z_CARACT_HAUTASPIMM': 'ATS_HAUTASPIMM', 'Z_CARACT_MARQTABL': 'ATS_MARQTABL', 'Z_CARACT_DIAM_UM_MILLIMETRE': 'ATS_DIAMETRE_UM', 'Z_CARACT_FABRIQUEENFRANCE': 'ATS_FABRIQUEENFRANCE', 'Z_CARACT_ORGANISMCIBLE': 'ATS_ORGANISMCIBLE', 'Z_CARACT_SOUFFLETCM': 'ATS_SOUFFLET_UM', 'Z_CARACT_ROTATIONECRAN': 'ATS_ROTATIONECRAN', 'Z_CARACT_LONGERON': 'ATS_LONGERON', 'Z_CARACT_CAPACITECANON_UM_LITREPARMINUTE': 'ATS_CAPACITECANON_UM', 'Z_CARACT_PIEDREGHCM': 'ATS_PIEDREGHCM', 'Z_CARACT_MARQUEMOTEUR': 'ATS_MARQUEMOTEUR', 'Z_CARACT_TECHNOLOGIE': 'ATS_TECHNOLOGIE', 'Z_CARACT_POPROCESS': 'ATS_PROCESSEUR', 'Z_CARACT_TCOPLARECY': 'ATS_TCOPLARECY_UM', 'Z_CARACT_MEMEXTMO': 'ATS_MEMEXTMO', 'Z_CARACT_ADAPTBOUTEAUST': 'ATS_ADAPTBOUTEAUSTERILE_LOV', 'Z_CARACT_POIDSVIDEO_unece_unit_KGM': 'ATS_POIDSVIDEO_UM', 'Z_CARACT_BLINDAGE': 'ATS_BLINDAGE', 'Z_CARACT_ECLAIREMENTLUX': 'ATS_ECLAIREMENTLUX', 'SAE_VL_ENERGIE': 'ATS_ENERGIE_VL_IMMAT_LOV', 'Z_CARACT_FREQWIFIGHZ': 'ATS_FREQWIFIGHZ', 'Z_CARACT_FORMATLU': 'ATS_FORMATLU', 'Z_CARACT_MATRIOBANDO': 'ATS_MATRIOBANDO', 'Z_CARACT_TYPEREGLAGE': 'ATS_TYPEREGLAGE', 'Z_CARACT_PORTETIQUETTE': 'ATS_PORTETIQUETTE_LOV', 'Z_CARACT_RESOLUTDVIMAXI': 'ATS_RESOLUTDVIMAXI', 'Z_CARACT_PRISVUELXLMM': 'ATS_PRISVUELXLMM', 'Z_CARACT_CONTMATRERECYCLE': 'ATS_CONTMATRERECYCLE', 'Produit.D√©signation = MCD MySQL (√† rev√©rifier c√¥t√© DSI)': 'ATS_LIBELLE_WEB', 'Z_CARACT_NUMBREGE': 'ATS_NUMBREGE_LOV', 'Z_CARACT_TYPTOILE': 'ATS_TYPTOILE', 'Z_CARACT_TYPCABLE': 'ATS_TYPCABLE', 'Z_CARACT_SYSTEMEFERMET': 'ATS_SYSTEMEFERMET', 'Z_CARACT_CLASDM': 'ATS_CLASDM', 'Z_CARACT_PLAGEMESUREDC': 'ATS_PLAGEMESUREDC', 'Z_CARACT_HAUTALONCM': 'ATS_HAUTALONCM', 'Z_CARACT_MISEPOINT': 'ATS_MISEPOINT', 'Z_CARACT_NOMENUNSPSC': 'ATS_NOMENUNSPSC', 'Z_CARACT_TYPESYSTEME': 'ATS_TYPESYSTEME', 'Z_CARACT_EPAISSEURMM': 'ATS_EPAISSEURMM', 'Z_CARACT_PLAGETEMPERATURDC': 'ATS_PLAGETEMPERATURDC', 'Z_CARACT_PTACT': 'ATS_PTACT', 'Z_CARACT_TYPELECTROPHORES': 'ATS_TYPELECTROPHORES', 'Z_CARACT_MEMOIRINTGO': 'ATS_MEMOIRINTGO', 'Z_CARACT_OUVERTURCONECTMM': 'ATS_OUVERTURCONECTMM', 'Z_CARACT_ZONECOMPLXHCM': 'ATS_ZONECOMPLXHCM', 'Z_CARACT_VIBREUR': 'ATS_VIBREUR_LOV', 'Z_CARACT_NBRESLOTTOTAL': 'ATS_NBRESLOTTOTAL', 'Z_CARACT_DEBITTRANCHEMIN': 'ATS_DEBITTRANCHEMIN', 'Z_CARACT_FLECHELUMIN': 'ATS_FLECHELUMIN_LOV', 'Z_CARACT_NBETIQPLANCHE': 'ATS_NBETIQPLANCHE', 'Z_CARACT_SOURCLUM': 'ATS_SOURCLUM', 'Z_CARACT_LONGUEURMM': 'ATS_LONGUEURMM', 'Z_CARACT_AUTOBATTAN': 'ATS_AUTONOMIEBATTERIEANNONCE', 'Z_CARACT_ENDUCTION': 'ATS_ENDUCTION', 'Z_CARACT_RESEAUSSFIL': 'ATS_RESAUSSFIL', 'Z_CARACT_MAILLELXLMM': 'ATS_MAILLELXLMM', 'Z_CARACT_SURPIEDS': 'ATS_SURPIEDS_LOV', 'Z_CARACT_RAPPORFOCALE': 'ATS_RAPPORFOCALE', 'Z_CARACT_AUTOCLAVABLE': 'ATS_AUTOCLAVABLE', 'Z_CARACT_TXTRANSDOMBS': 'ATS_TXTRANSDOMBS', 'Z_CARACT_MATSANGLE': 'ATS_MATSANGLE', 'Z_CARACT_LONGUEURASSISECM': 'ATS_LONGUEURASSISECM', 'Z_CARACT_CHARGDOC': 'ATS_CHARGEDOC_LOV', 'Z_CARACT_TYPEENCRE': 'ATS_TYPEENCRE', 'Z_CARACT_CAPMAXNBF': 'ATS_CAPACITEMAXNBF', 'Z_CARACT_NBPANNEAUX': 'ATS_NBPANNEAUX', 'Z_CARACT_OPERCUL': 'ATS_OPERCUL', 'Z_CARACT_NBRPRISESUSE': 'ATS_NBRPRISESUSE', 'Z_CARACT_NBBACS': 'ATS_NBBACS', 'Z_CARACT_TYPESTABILISATION': 'ATS_TYPESTABILISATION', 'Z_CARACT_BLOCAGDOSSIER': 'ATS_BLOCAGDOSSIER', 'Z_CARACT_METHODISOLEMENT': 'ATS_METHODISOLEMENT', 'Z_CARACT_COLORBAC': 'ATS_COLORISBAC', 'Z_CARACT_FORMAIMP': 'ATS_FORMAIMP', 'Z_CARACT_ENCOMBSOLLXLMM': 'ATS_ENCOMBSOLLXLMM', 'Z_CARACT_TYPTESTEUR': 'ATS_TYPTESTEUR', 'Z_CARACT_JAUGEAWG': 'ATS_JAUGEAWG', 'SAE_VL_CO2': 'ATS_EMISSION_CO2_VEHICULE', 'Z_CARACT_PANNEAURETROREF': 'ATS_PANNEAURETROREF_LOV', 'Z_CARACT_DOBSERVTIONM': 'ATS_DOBSERVTION_UM', 'Z_CARACT_TYPHARNAI': 'ATS_TYPHARNAI', 'Z_CARACT_MATRIOANCRAG': 'ATS_MATRIOANCRAG', 'Z_CARACT_CAPCOUPFEUIL': 'ATS_CAPCOUPFEUIL', 'Z_CARACT_MATERTRAP': 'ATS_MATERTRAP', 'Z_CARACT_RESOLDPI': 'ATS_RESOLDPI', 'Z_CARACT_CHARTABLKG': 'ATS_CHARTABLKG', 'Z_CARACT_MODULCINQG': 'ATS_MODULCINQG', 'Z_CARACT_SYSTGUIDLAME': 'ATS_SYSTGUIDLAME_LOV', 'Z_CARACT_CD': 'ATS_CD_LOV', 'Z_CARACT_PUBLICATION': 'ATS_PUBLICATION', 'Z_CARACT_TYPPIET': 'ATS_PITEMENTSTRUCTURE', 'Z_CARACT_CARACTERE_RESPONSABLE': 'ATS_CARACTERERESPONSABLE', 'Z_CARACT_NBCOMPRESSEURS': 'ATS_NBCOMPRESSEURS', 'Z_CARACT_CONSONECOVEILW': 'ATS_CONSONECOVEILW', 'Z_CARACT_TYPTRAITANTIBACTERIEN': 'ATS_TYPTRAITANTIBACTERIEN', 'Z_CARACT_TYPEFILTREAIR': 'ATS_TYPEFILTREAIR', 'Z_CARACT_NBRESACROUL': 'ATS_NBRESACROUL', 'Z_CARACT_MATROUDIR': 'ATS_MATROUDIR', 'Z_CARACT_PROFONDEURCM': 'ATS_PROFONDEURCM', 'Z_CARACT_TYPACOUDOIR': 'ATS_TYPACOUDOIR', 'Z_CARACT_DETECAUTODP': 'ATS_DETECAUTODP_LOV', 'SAE_VL_BLUETOOTH_VEHICULE': 'ATS_BLUETOOTH_VEHICULE', 'Z_CARACT_MATRIOSYSTMLIAISO': 'ATS_MATRIOSYSTMLIAISO', 'Z_CARACT_NORMLEVNF1650': 'ATS_NORMLEVNF1650', 'Z_CARACT_ROULETTESESCAMOTABLES': 'ATS_ROULETTESESCAMOTABLES_LOV', 'Z_CARACT_MATRIAUBAVOLET': 'ATS_MATRIAUBAVOLET', 'Z_CARACT_TYPEWAN': 'ATS_TYPEWAN', 'Z_CARACT_CLASSEDEHAUTEUR': 'ATS_CLASSEDEHAUTEUR', 'Z_CARACT_NORMVIRUCID': 'ATS_NORMVIRUCID', 'Z_CARACT_NBRETABLETTESREGL': 'ATS_NBRETABLETTESREGL', 'Z_CARACT_TYPVIDEOPRO': 'ATS_TYPVIDEOPRO', 'Z_CARACT_CHARGEDYNMAX_UM': 'ATS_CHARGEDYNMAX_UM', 'Z_CARACT_MOAPHTLHPRCM': 'ATS_MOAPHTLHPRCM', 'Z_CARACT_NBREPORTSWAN': 'ATS_NBREPORTSWAN', 'Z_CARACT_ESPECE': 'ATS_ESPECE', 'Z_CARACT_CAPNBPLAC': 'ATS_CAPACITENBPLAC', 'Z_CARACT_TRANSMISSION': 'ATS_TRANSMISSION', 'Z_CARACT_PALETTELXLCM': 'ATS_PALETTELXLCM', 'Z_CARACT_LOGIOCR': 'ATS_LOGIOCR', 'Z_CARACT_PUISSANCE': 'ATS_PUISSANCEHAUTPARLEUR_UM', 'Z_CARACT_HAUTIGECM': 'ATS_HAUTIGECM', 'Z_CARACT_LOGINTERINT': 'ATS_LOGINTERINT', 'Z_CARACT_PTACKG': 'ATS_PTACKG', 'Z_CARACT_NBRESLOTSFP': 'ATS_NBRESLOTSFP', 'Z_CARACT_LARGDOSCM': 'ATS_LARGDOS_UM', 'Z_CARACT_FORCESOUFFLAGE': 'ATS_FORCESOUFFLAGE', 'Z_CARACT_MARQORDIPORTAB': 'ATS_MARQORDIPORTAB', 'Z_CARACT_TYPMEMOIRE': 'ATS_TYPMEMOIRE', 'Z_CARACT_TEMCHARGH': 'ATS_TEMCHARGH', 'Z_CARACT_MATERIAUFUT': 'ATS_MATERIAUFUT', 'Z_CARACT_MANDIAMM': 'ATS_DIAMMANDRIN_UM', 'Z_CARACT_PLIABLE': 'ATS_PLIABLE_LOV', 'Z_CARACT_PUISSANCEKW ; Z_CARACT_PUISSANCEVA ; Z_CARACT_PUISSANCEW': 'ATS_PUISSANCE', 'Z_CARACT_DIAMCM': 'ATS_DIAMCM', 'Z_CARACT_NBEFENTE': 'ATS_NBEFENTE', 'Z_CARACT_CAPACSTOCK': 'ATS_CAPACITESTOCK', 'Z_CARACT_NBOPERCUL': 'ATS_NBOPERCUL', 'Z_CARACT_PROTECTTIBIA': 'ATS_PROTECTTIBIA_LOV', 'Z_CARACT_MARQUAGE': 'ATS_MARQUAGE', 'Z_CARACT_NBMAXUSERANCRAG': 'ATS_NBMAXUSERANCRAG', 'Z_CARACT_CAPNBCHAISES': 'ATS_CAPACITENBCHAISES', 'Z_CARACT_MECANISME': 'ATS_MECANISME', 'Z_CARACT_NBRECARTENCR': 'ATS_NBRECARTENCR', 'Z_CARACT_SYSSECUOUVERT': 'ATS_SYSSECUOUVERT_LOV', 'Z_CARACT_VITMAXENR': 'ATS_VITMAXENR', 'Z_CARACT_TRAVERSES': 'ATS_TRAVERSES', 'Z_CARACT_TLCPNUMABR': 'ATS_TLCPNUMABR', 'Z_CARACT_TYPEACCESSOIRE': 'ATS_TYPEACCESSOIRE', 'Z_CARACT_EPAISTRANCHEMM': 'ATS_EPAISTRANCHEMM', 'Z_CARACT_TEINTOCULAIR': 'ATS_TEINTOCULAIR', 'Z_CARACT_FENETRELXLMM': 'ATS_FENETRELXLMM', 'Z_CARACT_MAIN': 'ATS_MAIN', 'Z_CARACT_PUISSLAMPEW': 'ATS_PUISSLAMPE_UM', 'Z_CARACT_FORMETABLIER': 'ATS_FORMETABLIER', 'Z_CARACT_TABLETBASSE': 'ATS_TABLETBASSE_LOV', 'Z_CARACT_TYPEPLANTRAV': 'ATS_TYPEPLANTRAV', 'Z_CARACT_NBPERFO': 'ATS_NBPERFO', 'Z_CARACT_NBCOLONES': 'ATS_NBRECOLONES', 'Z_CARACT_BLUETOOTH': 'ATS_BLUETOOTH_LOV', 'Z_CARACT_MATRIOCOQILLE': 'ATS_MATRIOCOQILLE', 'Z_CARACT_STABIMAGE': 'ATS_STABIMAGE_LOV', 'Z_CARACT_CONECTLXHMM': 'ATS_CONECTLXHMM', 'Z_CARACT_MATCORDE': 'ATS_MATCORDE', 'Z_CARACT_TIRTRIMAXI': 'ATS_TIRTRIMAXI', 'Z_CARACT_FORMATLLMM': 'ATS_FORMATLLMM', 'Z_CARACT_STYLEPOINTE': 'ATS_STYLEPOINTE', 'Z_CARACT_FORMBAC': 'ATS_FORMBAC', 'Z_CARACT_HTAPPUI_UM_MILLIMETRE': 'ATS_HTAPPUI_UM', 'Z_CARACT_HORSTOUTLXHCM': 'ATS_HORSTOUTLXHCM', 'Z_CARACT_CAPAGRAF': 'ATS_CAPACITEAGRAF', 'Z_CARACT_MODELAMP': 'ATS_MODELAMP', 'Z_CARACT_TYPSIEGE': 'ATS_TYPESIEGE', 'Z_CARACT_PTSACCROCHARNAI': 'ATS_PTSACCROCHARNAI', 'Z_CARACT_LIFORMULE': 'ATS_LIFORMULE', 'Z_CARACT_MONTANTS': 'ATS_MONTANTS', 'Z_CARACT_DBLEBORDCOTE': 'ATS_DBLEBORDCOTE_LOV', 'Z_CARACT_DEBITKGH': 'ATS_DEBIT_UM', 'Z_CARACT_DOSSIEREGLABL': 'ATS_DOSSIEREGLABL', 'Z_CARACT_TYPCOUPE': 'ATS_TYPCOUPE', 'Z_CARACT_CLASSIFREACH': 'ATS_CLASSIFREACH', 'Z_CARACT_TAILLIMAGAFI': 'ATS_TAILLIMAGAFI', 'Z_CARACT_MULTIDIFF': 'ATS_MULTIDIFF_LOV', 'Z_CARACT_PIETREGLAVERIN': 'ATS_PIETREGLAVERIN_LOV', 'Z_CARACT_BACHTLXHXPRCM': 'ATS_BACHTLXHXPRCM', 'Z_CARACT_SYSTEMDEREGLA': 'ATS_SYSTEMDEREGLA', 'Z_CARACT_NNO': 'ATS_NNO', 'Z_CARACT_TYPEROBINET': 'ATS_TYPEROBINET', 'Z_CARACT_REPOSESAC': 'ATS_REPOSESAC_LOV', 'Z_CARACT_TEMPSEXTRACTIONMIN': 'ATS_TEMPSEXTRACTIONMIN', 'Z_CARACT_INTERFACSORT': 'ATS_INTERFACSORT', 'Z_CARACT_TYPCARTE': 'ATS_TYPCARTE', 'Z_CARACT_PUISSANCEW': 'ATS_PUISSANCEW', 'Z_CARACT_EQTINFO': 'ATS_EQTINFO', 'Z_CARACT_JUGULAIRE': 'ATS_JUGULAIRE_LOV', 'Z_CARACT_ECRANTACTIL': 'ATS_ECRANTACTIL', 'Z_CARACT_NBPOSTESMINMAX': 'ATS_NBPOSTESMINMAX', 'Z_CARACT_SURFCUISSONLXLCM': 'ATS_SURFCUISSONLXLCM', 'Z_CARACT_VIDEOHTLXHXPRCM': 'ATS_VIDEOHTLXHXPRCM', 'Z_CARACT_VITFAXTRANSPAG_UM_SECONDE': 'ATS_VITFAXTRANSPAG_UM', 'Z_CARACT_PURETEPC': 'ATS_PURETEPC', 'ED_TYPE_LOGICIEL_MULTIEDITEURS': 'ATS_ED_TYPE_LOGICIEL_MULTIEDITEURS', 'Z_CARACT_RAYONBRAQUMM': 'ATS_RAYONBRAQU_UM', 'Z_CARACT_TYPDISCDUR': 'ATS_TYPDISCDUR', 'Z_CARACT_ANGLEVUEHV': 'ATS_ANGLEVUEHV', 'Z_CARACT_NBECOUTEURS': 'ATS_NBECOUTEURS', 'Z_CARACT_MATERPLATFORM': 'ATS_MATERPLATFORM', 'Z_CARACT_TIRANTEAU_UM_METRE': 'ATS_TIRANTEAU_UM', 'Z_CARACT_SURFPROJLXHCM': 'ATS_SURFPROJLXHCM', 'Z_CARACT_MATERIOTETE': 'ATS_MATERIOTETE', 'Z_DETACHABLEMICROPERF': 'ATS_DETACHABLEMICROPERF', 'Z_CARACT_GUIDAGE': 'ATS_GUIDAGE', 'Z_CARACT_TYPETETE': 'ATS_TYPETETE', 'Z_CARACT_RELEVBUSTE': 'ATS_RELEVEBUSTE', 'Z_CARACT_CONNEXIONORDI': 'ATS_CONNEXIONORDI', 'Z_CARACT_NIVEAUSECUDIN': 'ATS_NIVEAUSECUDIN', 'Z_CARACT_LUMINORECOLUM': 'ATS_LUMINORECOLUMLM', 'Z_CARACT_DESMOLECULCIBLE': 'ATS_DESMOLECULCIBLE', 'Z_CARACT_FOURCHLXLMM': 'ATS_FOURCHLXLMM', 'Z_CARACT_GARANTIECONSTR': 'ATS_GARANTIECONSTR', 'Z_CARACT_TYPEMOUSSE': 'ATS_TYPEMOUSSE', 'Z_CARACT_DIAGIMINMAXM': 'ATS_DIAGIMINMAXM', 'Z_CARACT_MATRIODOUBLUR': 'ATS_MATRIODOUBLUR', 'Z_CARACT_SERRURE': 'ATS_SERRURE_LOV', 'Z_CARACT_NBBOUTEILL': 'ATS_NBBOUTEILL', 'Z_CARACT_HAUTENTPLATMM': 'ATS_HAUTENTPLATMM', 'Z_CARACT_CAPACIT_unece.unit.KGM ; Z_CARACT_CAPMCUBE_UM.M3 ; Z_CARACT_CAPACIT1_UM.U': 'ATS_CAPACITE_UM', 'Z_CARACT_CHANT': 'ATS_CHANT', 'Z_CARACT_MATROUFOURCH': 'ATS_MATROUFOURCH', 'Z_CARACT_PTECLAIRDC': 'ATS_PTECLAIRDC', 'Z_CARACT_VITESSECR': 'ATS_VITESSECR', 'Z_CARACT_TYPBAIE': 'ATS_TYPBAIE', 'Z_CARACT_CAPMODNOR': 'ATS_CAPMODNOR', 'Z_CARACT_NBREBATTERIES': 'ATS_NBREBATTERIES', 'Z_CARACT_CAPCORBEILL_UM_LITRE': 'ATS_CAPACITECORBEILLE_UM', 'Z_CARACT_ALIMBACF': 'ATS_ALIMBACF', 'Z_CARACT_PROFONDEURAGRAFAGE': 'ATS_PROFONDEURAGRAFAGE', 'Z_CARACT_MARQTNI': 'ATS_MARQTNI', 'Z_CARACT_DISPMEMOIRE': 'ATS_DISPMEMOIRE', 'Z_CARACT_TYPE': 'ATS_TYPE', 'Z_CARACT_NBDOSSIERS': 'ATS_NBDOSSIERS', 'Z_CARACT_MATSOCLE': 'ATS_MATSOCLE', 'Z_CARACT_COIFFE': 'ATS_COIFFE_LOV', 'Z_CARACT_ORIGINE': 'ATS_ORIGINE', 'Z_CARACT_TYPEBRAS': 'ATS_TYPEBRAS', 'Z_CARACT_ENVERGUREMM': 'ATS_ENVERGUREMM', 'Z_CARACT_ROBINETVID': 'ATS_ROBINETVID_LOV', 'Z_CARACT_CLASSENERGIE': 'ATS_CLASSENERGIE', 'Z_CARACT_NBPIEDS': 'ATS_NBPIEDS', 'W_BIOMED_CONDITIONNEMENT': 'ATS_BIOMED_CONDITIONNEMENT', 'Z_CARACT_TRAITEMENTSON': 'ATS_TRAITEMENTSON', 'Z_CARACT_TYPCOMMANDE': 'ATS_TYPCOMMANDE', 'Z_CARACT_CLASSEOPTIQUE': 'ATS_CLASSEOPTIQUE', 'Z_CARACT_MEMOIREVIVE': 'ATS_MEMOIREVIVE', 'Z_CARACT_TYPSERVEUR': 'ATS_TYPSERVEUR', 'Z_CARACT_MATRIOSERTETE': 'ATS_MATRIOSERTETE', 'Z_CARACT_PROTECTALON': 'ATS_PROTECTALON', 'Z_CARACT_TAUXERREURPC': 'ATS_TAUXERREURPC', 'Z_CARACT_NORMELABEL': 'ATS_NORMELABEL', 'Z_CARACT_PUISSMOTEURCH': 'ATS_PUISSMOTEURCH', 'Z_CARACT_NBELEMENTSTELESCOPIQUES': 'ATS_NBELEMENTSTELESCOPIQUES', 'Z_CARACT_VITIMPLIST_UM_CARACTERPARSECONDE': 'ATS_VITIMPLIST_UM', 'Z_CARACT_TYPMEMVIVE': 'ATS_TYPMEMVIVE', 'Z_CARACT_MICROORGANISME': 'ATS_MICROORGANISME', 'Z_CARACT_MODLEDVIDEOPRO': 'ATS_MODLEDVIDEOPRO', 'Z_CARACT_AMPLITEMPDC': 'ATS_AMPLITEMPDC', 'Z_CARACT_NBBAIESSTOCKAG': 'ATS_NBBAIESSTOCKAG', 'Z_CARACT_TYPBATTERIE': 'ATS_TYPBATTERIE', 'Z_CARACT_INTERFIEE': 'ATS_INTERFIEE_LOV', 'Z_CARACT_NBPLATEAU': 'ATS_NBPLATEAU', 'Z_CARACT_COMPATIBLEENDO': 'ATS_COMPATIBLEENDO', 'Z_CARACT_BASEDIAM_UM_MILLIMETRE': 'ATS_DIAMBASE_UM', 'Z_CARACT_TCOCERTIFIED': 'ATS_TCOCERTIFIED', 'Z_CARACT_POIDSTOTAL_unece_unit_KGM': 'ATS_POIDSTOTAL_UM', 'Z_CARACT_TENSIONV': 'ATS_TENSIONV', 'Z_CARACT_PAGRAMIMAXG': 'ATS_PAGRAMIMAXG', 'Z_CARACT_CAPUCHE': 'ATS_CAPUCHE', 'Z_CARACT_CAMERA': 'ATS_CAMERA', 'SAE_VL_CONSTRUCTEUR': 'ATS_MARQUE_LOV', 'Z_CARACT_TCOCONSENEANKWH': 'ATS_TCOCONSENEAN_UM', 'Z_CARACT_PROFMARCHE_UM_MILLIMETRE': 'ATS_PROFMARCHE_UM', 'Z_CARACT_TAILLEP': 'ATS_TAILLEP', 'Z_CARACT_EXTMEMOMAXI': 'ATS_EXTMEMOMAXI', 'Z_CARACT_NBPASSAGMIN': 'ATS_NBPASSAGMIN', 'Z_CARACT_DISTRUB': 'ATS_DISTRUB', 'Z_CARACT_MATERIAUMONT': 'ATS_MATERIAUMONT', 'Z_CARACT_TYPOUTIL': 'ATS_TYPOUTIL', 'Z_CARACT_DUREVIENECOH': 'ATS_DUREVIENECOH', 'Z_CARACT_MICRO': 'ATS_MICRO_LOV', 'Z_CARACT_FREQMEMMHZ': 'ATS_FREQUENCEHMEMOIRE_UM', 'Z_CARACT_ALIMBACQUAF': 'ATS_ALIMBAC4', 'Z_CARACT_ALIMBACDEUF': 'ATS_ALIMBAC2', 'Z_CARACT_RSISTANCEMCANIQ': 'ATS_RSISTANCEMCANIQ', 'Z_CARACT_ALIMBACTROIF': 'ATS_ALIMBAC3', 'Z_CARACT_PERSONNALISATIO': 'ATS_PERSONNALISATIO_LOV', 'Z_CARACT_HAUTEURMM': 'ATS_HAUTEURMM', 'Z_CARACT_ALIMBACUNF': 'ATS_ALIMBAC1', 'Z_CARACT_TYPEDEDIABLE': 'ATS_TYPEDEDIABLE', 'Z_CARACT_POIDSAVIDEKG': 'ATS_POIDSAVIDEKG', 'Z_CARACT_NBPOCHETTE': 'ATS_NBPOCHETTE', 'Z_CARACT_FFEUILLE': 'ATS_FFEUILLE_LOV', 'Z_CARACT_NBPORTSSORTDCM': 'ATS_NBPORTSSORTDCM', 'Z_CARACT_NBCASCOL': 'ATS_NBCASCOL', 'Z_CARACT_NBRETABLETTES': 'ATS_NBRETABLETTES', 'Z_CARACT_EPAISCAIS_UM_MILLIMETRE': 'ATS_EPAISCAIS_UM', 'Z_CARACT_FONCTREVEIL': 'ATS_FONCTREVEIL_LOV', 'Z_CARACT_NBPORTSSORTDC': 'ATS_NBPORTSSORTDC', 'Z_CARACT_EPAISPLATEAUMM': 'ATS_EPAISPLATEAUMM', 'Z_CARACT_DEBIWIFIMBITS': 'ATS_DEBIWIFIMBITS', 'Z_CARACT_NBRCOUVERT': 'ATS_NBRCOUVERT', 'Z_CARACT_COULEURECLAIRAGE': 'ATS_COULEURECLAIRAGE', 'Z_CARACT_CATCABLE': 'ATS_CATEGORIECABLE', 'Z_CARACT_VISIONDEG': 'ATS_VISION_UM', 'Z_CARACT_ECOLABFLEU': 'ATS_ECOLABFLEU', 'Z_CARACT_HORSTOUTLXLXHM': 'ATS_HORSTOUTLXLXHM', 'Z_CARACT_LECTEUROPTIQ': 'ATS_LECTEUROPTIQUE', 'Z_CARACT_DETECTIONDESROTOR': 'ATS_DETECDESEQROTOR_LOV', 'Z_CARACT_PRECRAN': 'ATS_PRECRAN', 'Z_CARACT_TABLETTE': 'ATS_TABLETTE', 'Z_CARACT_ECRANAFICH': 'ATS_ECRANAFICH', 'Z_CARACT_PROTEMALLOLE': 'ATS_PROTEMALLOLE_LOV', 'Z_CARACT_ENCRAGE': 'ATS_ENCRAGE', 'Z_CARACT_NOCAS': 'ATS_NOCAS', 'Z_CARACT_NBREPATERES': 'ATS_NBREPATERES', 'Z_CARACT_PIEDSREGLAB': 'ATS_PIEDSREGLAB_LOV', 'Z_CARACT_PAVNUMINT': 'ATS_PAVNUMINT', 'ED_TYPE_LICENCE_MULTIEDITEURS': 'ATS_ED_TYPE_LICENCE_MULTIEDITEURS', 'Z_CARACT_TAUXTRANSFMOS': 'ATS_TAUXTRANSFMOS', 'Z_CARACT_MATERIAUCHANT': 'ATS_MATERIAUCHANT', 'Z_CARACT_TETEDIAMCM': 'ATS_TETEDIAMCM', 'Z_CARACT_TYPEMOTEUR': 'ATS_TYPEMOTEUR', 'Z_CARACT_INTERFACENTR': 'ATS_INTERFACENTR', 'Z_CARACT_CONDITIONCONS': 'ATS_CONDITIONCONSEILLE', 'Z_CARACT_ONDES': 'ATS_ONDES', 'Z_CARACT_LIVRE': 'ATS_LIVRE', 'Z_CARACT_QUALITENREG': 'ATS_QUALITENREG', 'Z_CARACT_FILTRE': 'ATS_FILTRE', 'Z_CARACT_FORMAXI': 'ATS_FORMAXI', 'Z_CARACT_POIDAVCEMBKG': 'ATS_POIDAVCEMB_UM', 'Z_CARACT_CHARGEMAXIADMKG': 'ATS_CHARGEMAXIADMKG', 'Z_CARACT_MEMINTBAL_UM_GIGAOCTET': 'ATS_MEMINTBAL_UM', 'Z_CARACT_TEINTOCULABL': 'ATS_TEINTOCULABL', 'Z_CARACT_ZONEMAINTIEN': 'ATS_ZONEMAINTIEN', 'SAE_VL_USAGE': 'ATS_SAE_VL_USAGE', 'Z_CARACT_TAILLECRANTABP': 'ATS_TAILLECRANTAB', 'Z_CARACT_CYLINDRCMC': 'ATS_CYLINDRCMC', 'Z_CARACT_DEBIAIRAMCAMCH': 'ATS_DEBIAIRAMCAMCH', 'Z_CARACT_SYSEXPLOITTAB': 'ATS_SYSEXPLOITTAB', 'Z_CARACT_TEMPCOULEURK': 'ATS_TEMPCOULEURK', 'Z_CARACT_ECRAN': 'ATS_ECRAN', 'Z_CARACT_LONGUEURSEQUENC': 'ATS_LONGUEURSEQUENC', 'Z_CARACT_TECHNO3D': 'ATS_TECHNO3D_LOV', 'Z_CARACT_TYPROBUST': 'ATS_TYPROBUST', 'Z_CARACT_EPASSISEMM': 'ATS_EPASSISEMM', 'Z_CARACT_PTMOUSSANT': 'ATS_PTMOUSSANT_LOV', 'Z_CARACT_VITESSETRMIN': 'ATS_VITESSETRMIN', 'Z_CARACT_NUMFILMNEG': 'ATS_NUMFILMNEG_LOV', 'Z_CARACT_BRASJAMBESARTICUL': 'ATS_BRASJAMBESARTICUL_LOV', 'Z_CARACT_USAGE': 'ATS_USAGE', 'Z_CARACT_SERTETE': 'ATS_SERTETE', 'Z_CARACT_TYPMULTIFCT': 'ATS_TYPMULTIFCT', 'Z_CARACT_VINUMCOUL': 'ATS_VINUMCOUL', 'Z_CARACT_SORTIEPAPF': 'ATS_SORTIEPAPF', 'Z_CARACT_TECHNOVIDEOPRO': 'ATS_TECHNOVIDEOPRO', 'Z_CARACT_CHLORACTIF_UM_POURCENT': 'ATS_CHLORACTIF_UM', 'Z_CARACT_FIBFORDUR_UM_POURCENT': 'ATS_FIBFORDUR_UM', 'Z_CARACT_TYPPROTEINE': 'ATS_TYPPROTEINE', 'Z_CARACT_LONGUEURECRITURE': 'ATS_LONGUEURECRITURE', 'Z_CARACT_POCHESINTRIEUR': 'ATS_POCHESINTRIEUR', 'Z_CARACT_TRAITEMENT': 'ATS_TRAITEMENT', 'Z_CARACT_TAILLE': 'ATS_TAILLE', 'Z_CARACT_AVTRENFORCE': 'ATS_AVANTRENFORCE_LOV', 'Z_CARACT_GRAMMAGENVELGMCA': 'ATS_GRAMMAGENVELGE_UM', 'Z_CARACT_HAUTASSISECM': 'ATS_HAUTASSISECM', 'Z_CARACT_NBPTSCONTACT': 'ATS_NBPTSCONTACT', 'Z_CARACT_TABLEAUCOMM': 'ATS_TABLEAUCOMM', 'Z_CARACT_RESOLUTVIDEO': 'ATS_RESOLUTVIDEO', 'Z_CARACT_VITESSEMAX': 'ATS_VITESSEMAX', 'Z_CARACT_ECOLABANBL': 'ATS_ECOLABANBL_LOV', 'Z_CARACT_TYPETOITURE': 'ATS_TYPETOITURE', 'Z_CARACT_AERATION': 'ATS_AERATION', 'Z_CARACT_MATERIAUCHAS': 'ATS_MATERIAUCHAS', 'Z_CARACT_CORDIAMMM': 'ATS_CORDIAMMM', 'Z_CARACT_RECONDITIONNE': 'ATS_RECONDITIONNE', 'Z_CARACT_VITCOPIMPCA4_PPM': 'ATS_VITCOPIMPCA4PPM', 'Z_CARACT_STRUCTURE': 'ATS_STRUCTURE', 'Z_CARACT_TYPETRANSLA': 'ATS_TYPETRANSLA'}

WHITELIST_COLUMNS_PRODUIT = ["Reference", "Marche", "Designation", "PointFort", "Description","Norme", "Garantie", "Origine", "Prestation", "UrlImg", "Type"]
WHITELIST_COLUMNS_ATTRIBUT_PRODUIT = ["IdAttribut", "Reference", "Valeur", "AttributPivot", "Ordre"]
WHITELIST_COLUMNS_PRODUIT_ASSOCIE = ["Reference","ReferenceAssociee"]
WHITELIST_COLUMNS_PRODUIT_GROUPE_OPTION = ["Reference","RefProduitOption","Ordre", "IdGroupeOption"]
WHITELIST_COLUMNS_GROUPES_OPTION_DEFS = ["IdGroupeOption", "Libelle", "Minimum", "Maximum"]

MAPPING_PRODUIT = {
    "Designation": "ATS_DESIGNATION_WEB",
    "PointFort": "ATS_POINTS_FORTS",
    "PlusProduit": "ATS_PLUS_PRODUIT",
    "UrlImg": "ATD_RATTACH_VISU_FRN",
    "Origine": "ATS_ORIGINE_PRODUIT",
    "Garantie": "ATS_GARANTIE_PRINCIPALE",
    "Prestation": "ATS_PRESTATION_LIVRAISON",
    "Slug": "ATS_SLUG_URL",
    "EstVendu??": "ATS_EST_VENDU",
}

def charger_lien_produit_option(folder="data", output="output"):
    os.makedirs(output, exist_ok=True)
    for filename in os.listdir(folder):
        if filename.startswith("produit_groupe_option") and filename.endswith(".csv"):
            path = os.path.join(folder, filename)
            try:
                df = pd.read_csv(path, sep=";", dtype=str, encoding="utf-8-sig", on_bad_lines="skip")
                df.columns = df.columns.str.strip()
                df = df[[col for col in df.columns if col in WHITELIST_COLUMNS_PRODUIT_GROUPE_OPTION]]
                df = df.dropna(axis=1, how="all")
                print(f"‚úÖ {filename} export√© : {df.shape[0]} lignes")
                return df, os.path.splitext(filename)[0]
            except Exception as e:
                print(f"‚ùå Erreur sur {filename} : {e}")
                return None


def charger_rattachement(path="data/FICHIER_DE_RATTACHEMENT_5_MARCHCES.xlsx"):
    df = pd.read_excel(path, sheet_name=0, dtype=str)
    df.columns = df.columns.str.strip()

    ref_col = "N¬∞ R√©f√©rence UGAP"
    parent_col = "ID NOEUD HP"

    if ref_col not in df.columns or parent_col not in df.columns:
        raise ValueError("‚ùå Colonnes attendues manquantes dans le fichier Excel")

    df = df.dropna(subset=[ref_col, parent_col])
    rattachement_dict = {
        str(row[ref_col]).strip(): str(row[parent_col]).strip()
        for _, row in df.iterrows()
    }

    print(f"‚úÖ Rattachement charg√© : {len(rattachement_dict)} r√©f√©rences depuis fichier Excel")
    return rattachement_dict


def build_step_groupe_option_file(df_lien_produit_option, df_groupes_option_definitions, rattachement_dict, base_name, output_dir="output"):
    output_path = os.path.join(output_dir, f"{base_name}.xml")
    os.makedirs(os.path.dirname(output_path), exist_ok=True)

    required_cols_pgo = {"Reference", "RefProduitOption", "IdGroupeOption"}
    required_cols_go = {"IdGroupeOption", "Libelle", "Minimum", "Maximum"}

    if not required_cols_pgo.issubset(df_lien_produit_option.columns):
        raise ValueError(f"‚ùå produit_groupe_option.csv doit contenir les colonnes {required_cols_pgo}")
    if not required_cols_go.issubset(df_groupes_option_definitions.columns):
        raise ValueError(f"‚ùå groupe_option.csv doit contenir les colonnes {required_cols_go}")

    groupe_mapping = {
        str(row["IdGroupeOption"]).strip(): {
            "libelle": str(row["Libelle"]).strip(),
            "min": str(row["Minimum"]).strip(),
            "max": str(row["Maximum"]).strip(),
        }
        for _, row in df_groupes_option_definitions.iterrows()
        if pd.notna(row["IdGroupeOption"])
    }

    step_root = etree.Element("STEP-ProductInformation", ContextID="UGAP_fr-FR", WorkspaceID="Main", UseContextLocale="false")
    products_elem = etree.SubElement(step_root, "Products")

    for _, row in df_lien_produit_option.iterrows():
        ref_standard = str(row.get("Reference", "")).strip()
        ref_option = str(row.get("RefProduitOption", "")).strip()
        id_groupe = str(row.get("IdGroupeOption", "")).strip()

        if not ref_option or not id_groupe:
            continue

        parent_id = rattachement_dict.get(ref_standard, "").strip()
        if not parent_id:
            # print(f"‚ö†Ô∏è Aucun ParentID trouv√© pour {ref_standard}, ligne ignor√©e")
            continue

        groupe_info = groupe_mapping.get(id_groupe)
        if not groupe_info:
            print(f"‚ö†Ô∏è Groupe {id_groupe} non trouv√© dans groupe_option.csv, ligne ignor√©e")
            continue

        product_elem = etree.SubElement(products_elem, "Product", UserTypeID="P_TYPOPT", ParentID=parent_id)
        etree.SubElement(product_elem, "KeyValue", KeyID="KEY_REF_UGAP").text = ref_option
        etree.SubElement(product_elem, "Name").text = groupe_info["libelle"]

        values_elem = etree.SubElement(product_elem, "Values")
        etree.SubElement(values_elem, "Value", AttributeID="ATD_GRP_OPT_QTE_MIN").text = groupe_info["min"]
        etree.SubElement(values_elem, "Value", AttributeID="ATD_GRP_OPT_QTE_MAX").text = groupe_info["max"]
    # # === Export des r√©f√©rences ignor√©es (sans ParentID)
    # refs_non_trouvees = []
    # for _, row in df_lien_produit_option.iterrows():
    #     ref_standard = str(row.get("Reference", "")).strip()
    #     if ref_standard and ref_standard not in rattachement_dict:
    #         refs_non_trouvees.append(ref_standard)

    # if refs_non_trouvees:
    #     df_non_pris = pd.DataFrame(sorted(set(refs_non_trouvees)), columns=["Reference_sans_ParentID"])
    #     csv_path = os.path.join(os.path.dirname(output_path), "references_non_trouvees.csv")
    #     df_non_pris.to_csv(csv_path, sep=";", index=False, encoding="utf-8")
    #     print(f"‚ö†Ô∏è {len(df_non_pris)} r√©f√©rences sans ParentID export√©es dans : {csv_path}")

    tree = etree.ElementTree(step_root)
    tree.write(output_path, encoding="utf-8", pretty_print=True, xml_declaration=True)
    print(f"‚úÖ groupe_option.xml g√©n√©r√© : {output_path}")

def clean_xml_text(text):
    if not isinstance(text, str):
        return text
    text = html.unescape(text)
    remplacements = {
        '‚Äô': "'", '‚Äò': "'", '‚Äú': '"', '‚Äù': '"',
        '‚Äì': '-', '‚Äî': '-', '≈ì': 'oe', '≈í': 'OE',
        '‚Ç¨': 'EUR', '‚ÄØ': ' ', '¬†': ' ',
        '‚Äã': '', '‚Ä¶': '...', '‚Äö': ',', '‚Ä¢': '-', '‚ô¶': '',
        '¬≥': '3', '¬≤': '2', '¬Ω': '1/2', '¬º': '1/4'
    }
    for k, v in remplacements.items():
        text = text.replace(k, v)
    text = unicodedata.normalize("NFKC", text)
    text = re.sub(r'\s+', ' ', text).strip()
    try:
        text.encode('iso-8859-15')
    except UnicodeEncodeError as e:
        raise ValueError(f"Texte invalide pour l'encodage ISO-8859-15 : {text}") from e
    return text

def nettoyer_html(texte):
    if pd.isna(texte):
        return texte
    texte = re.sub(r"<[^>]+>", "", texte)
    texte = re.sub(r"&nbsp;|&#160;", " ", texte)
    return texte.strip()

def traiter_produit(folder="data", output="output", return_df=False):
    os.makedirs(output, exist_ok=True)
    for filename in os.listdir(folder):
        if filename.startswith("produit") and filename.endswith(".csv") and "associe" not in filename and "groupe_option" not in filename:
            path = os.path.join(folder, filename)
            try:
                with open(path, "rb") as f:
                    enc = chardet.detect(f.read())["encoding"]
                df = pd.read_csv(path, sep=";", dtype=str, encoding=enc, on_bad_lines="skip")
                df.columns = df.columns.str.strip().str.replace('"', '').str.replace("'", '')
                df = df[[col for col in WHITELIST_COLUMNS_PRODUIT if col in df.columns]]
                df = df.dropna(axis=1, how="all")
                for col in ["PointFort", "Description", "Prestation"]:
                    if col in df.columns:
                        df[col] = df[col].apply(nettoyer_html)
                base_name = os.path.splitext(filename)[0]
                output_path = os.path.join(output, f"{base_name}_nettoye.csv")
                # df.to_csv(output_path, sep=";", index=False, encoding="utf-8")
                print(f"‚úÖ Produit export√© : {output_path} ({df.shape[0]} lignes)")
                return (df if return_df else output_path), base_name
            except Exception as e:
                print(f"‚ùå Erreur sur produit : {e}")
                return None, None

def traiter_attribut_produit(folder="data", output="output", return_df=False):
    os.makedirs(output, exist_ok=True)
    for filename in os.listdir(folder):
        if filename.startswith("attribut_produit") and filename.endswith(".csv"):
            path = os.path.join(folder, filename)
            try:
                df = pd.read_csv(path, sep=";", dtype=str, encoding="utf-8-sig", on_bad_lines="skip")
                df.columns = df.columns.str.strip()
                df = df[[col for col in df.columns if col in WHITELIST_COLUMNS_ATTRIBUT_PRODUIT]]
                df = df.dropna(axis=1, how="all")
                if "AttributPivot" in df.columns:
                    uniques = df["AttributPivot"].dropna().unique()
                    if len(uniques) == 1 and uniques[0] in ["0", 0, 0.0]:
                        df.drop(columns=["AttributPivot"], inplace=True)
                        print("üßπ 'AttributPivot' supprim√©e (ne contient que des 0)")
                if "IdAttribut" not in df.columns:
                    print(f"‚ö†Ô∏è Pas de colonne 'IdAttribut' dans {filename}")
                    return None
                df_original = df.copy()
                df["IdAttribut"] = df["IdAttribut"].map(MAPPING_BO_STEP)
                df = df.dropna(subset=["IdAttribut"])
                df_rejetes = df_original[df_original["IdAttribut"].map(MAPPING_BO_STEP).isna()]
                base_name = os.path.splitext(filename)[0]
                # if not df_rejetes.empty:
                #     rejet_path = os.path.join(output, f"{base_name}_rejetes.csv")
                #     df_rejetes.to_csv(rejet_path, sep=";", index=False, encoding="utf-8")
                #     print(f"‚ö†Ô∏è {len(df_rejetes)} lignes rejet√©es export√©es : {rejet_path}")
                output_path = os.path.join(output, f"{base_name}_nettoye.csv")
                # df.to_csv(output_path, sep=";", index=False, encoding="utf-8")
                print(f"‚úÖ attribut_produit export√© : {output_path} ({df.shape[0]} lignes)")
                return df if return_df else output_path
            except Exception as e:
                print(f"‚ùå Erreur sur attribut_produit : {e}")
                return None

def charger_produit_associe(folder="data", output="output"):
    os.makedirs(output, exist_ok=True)
    for filename in os.listdir(folder):
        if filename.startswith("produit_associe") and filename.endswith(".csv"):
            path = os.path.join(folder, filename)
            try:
                df = pd.read_csv(path, sep=";", dtype=str, encoding="utf-8-sig", on_bad_lines="skip")
                df.columns = df.columns.str.strip()
                df = df[[col for col in df.columns if col in WHITELIST_COLUMNS_PRODUIT_ASSOCIE]]
                df = df.dropna(axis=1, how="all")
                base_name = os.path.splitext(filename)[0]
                output_path = os.path.join(output, f"{base_name}_nettoye.csv")
                # df.to_csv(output_path, sep=";", index=False, encoding="utf-8")
                print(f"‚úÖ {filename} export√© : {output_path} ({df.shape[0]} lignes)")
                return df
            except Exception as e:
                print(f"‚ùå Erreur sur {filename} : {e}")
                return None

def charger_groupe_option(folder="data", output="output"):
    os.makedirs(output, exist_ok=True)
    for filename in os.listdir(folder):
        if filename.startswith("produit_groupe_option") and filename.endswith(".csv"):
            path = os.path.join(folder, filename)
            try:
                df = pd.read_csv(path, sep=";", dtype=str, encoding="utf-8-sig", on_bad_lines="skip")
                df.columns = df.columns.str.strip()
                df = df[[col for col in df.columns if col in WHITELIST_COLUMNS_PRODUIT_GROUPE_OPTION]]
                df = df.dropna(axis=1, how="all")
                base_name = os.path.splitext(filename)[0]
                output_path = os.path.join(output, f"{base_name}_nettoye.csv")
                # df.to_csv(output_path, sep=";", index=False, encoding="utf-8")
                print(f"‚úÖ {filename} export√© : {output_path} ({df.shape[0]} lignes)")
                return df
            except Exception as e:
                print(f"‚ùå Erreur sur {filename} : {e}")
                return None
            
def ajouter_produits_associes(produit_elem, ref, df_associe):
    lignes = df_associe[df_associe["Reference"] == ref]
    if not lignes.empty:
        assoc_elem = etree.SubElement(produit_elem, "AssociatedProducts")
        for _, row in lignes.iterrows():
            etree.SubElement(assoc_elem, "ProductRef", Reference=row["ReferenceAssociee"])

def ajouter_groupe_options(produit_elem, ref, df_groupe_option):
    lignes = df_groupe_option[df_groupe_option["Reference"] == ref]
    if not lignes.empty:
        groupes_elem = etree.SubElement(produit_elem, "GroupesOptions")
        for _, row in lignes.iterrows():
            groupe_elem = etree.SubElement(groupes_elem, "GroupeOption", Nom=row.get("NomGroupeOption", ""))
            etree.SubElement(groupe_elem, "ReferenceOption").text = row["RefProduitOption"]

def export_stepxml(df_produit, df_attribut, base_name, df_associe=None, df_groupe_option=None, output_dir="output"):
    import logging
    logging.basicConfig(level=logging.INFO, format="[%(levelname)s] %(message)s")

    output_path = os.path.join(output_dir, f"{base_name}.xml")
    step_root = etree.Element("STEP-ProductInformation",
        ExportContext="UGAP_fr-FR", ContextID="UGAP_fr-FR",
        WorkspaceID="Main", UseContextLocale="false")
    products_elem = etree.SubElement(step_root, "Products")

    for _, prod in df_produit.iterrows():
        ref = str(prod["Reference"])
        type_val = str(prod.get("Type", "")).strip().lower()

        produit_elem = etree.SubElement(products_elem, "Product")
        etree.SubElement(produit_elem, "KeyValue", KeyID="KEY_REF_UGAP").text = ref
        values_elem = etree.SubElement(produit_elem, "Values")

        for col, attr_id in MAPPING_PRODUIT.items():
            val = prod.get(col)
            if pd.notna(val) and str(val).strip():
                etree.SubElement(values_elem, "Value", AttributeID=attr_id).text = clean_xml_text(val)

        subset = df_attribut[df_attribut["Reference"] == ref]
        for _, attr in subset.iterrows():
            attr_id = attr["IdAttribut"]
            attr_val = attr["Valeur"]
            if pd.notna(attr_id) and pd.notna(attr_val):
                etree.SubElement(values_elem, "Value", AttributeID=attr_id).text = clean_xml_text(attr_val)

        # === Groupe Option : lien REF_TYPOPT_OPT si Option, REF_PRD_OPT_TYPOPT si Standard
        if df_groupe_option is not None:
            if type_val == "standard":
                rows = df_groupe_option[df_groupe_option["Reference"] == ref]
                for _, row in rows.iterrows():
                    ref_option = str(row.get("RefProduitOption", "")).strip()
                    ordre = str(row.get("Ordre", "")).strip()
                    if ref_option:
                        pcr = etree.SubElement(produit_elem, "ProductCrossReference", Type="REF_PRD_OPT_TYPOPT")
                        etree.SubElement(pcr, "KeyValue", KeyID="KEY_REF_UGAP").text = ref_option
                        metadata = etree.SubElement(pcr, "MetaData")
                        etree.SubElement(metadata, "Value", AttributeID="ATD_ORDRE_ART_OPT_GRP_OPT").text = ordre

            elif type_val == "option":
                rows = df_groupe_option[df_groupe_option["RefProduitOption"] == ref]
                for _, row in rows.iterrows():
                    ref_standard = str(row.get("Reference", "")).strip()
                    ordre = str(row.get("Ordre", "")).strip()
                    if ref_standard:
                        pcr = etree.SubElement(produit_elem, "ProductCrossReference", Type="REF_TYPOPT_OPT")
                        etree.SubElement(pcr, "KeyValue", KeyID="KEY_REF_UGAP").text = ref_standard
                        metadata = etree.SubElement(pcr, "MetaData")
                        etree.SubElement(metadata, "Value", AttributeID="ATD_ORDRE_ART_OPT_GRP_OPT").text = ordre

        # === Accessoires (seulement si Standard)
        if df_associe is not None and type_val == "standard":
            rows = df_associe[df_associe["Reference"] == ref]
            for _, row in rows.iterrows():
                ref_assoc = str(row.get("ReferenceAssociee", "")).strip()
                if ref_assoc:
                    pcr = etree.SubElement(produit_elem, "ProductCrossReference", Type="REF_PRD_ACCESSOIRE")
                    etree.SubElement(pcr, "KeyValue", KeyID="KEY_REF_UGAP").text = ref_assoc

    tree = etree.ElementTree(step_root)
    tree.write(output_path, encoding="utf-8", pretty_print=True, xml_declaration=True)
    logging.info(f"‚úÖ Export XML : {output_path}")
    return output_path

def charger_groupe_option_definition(folder="data", output="output"):
    os.makedirs(output, exist_ok=True)
    for filename in os.listdir(folder):
        if filename.startswith("groupe_option") and filename.endswith(".csv"):
            path = os.path.join(folder, filename)
            try:
                df = pd.read_csv(path, sep=";", dtype=str, encoding="utf-8-sig", on_bad_lines="skip")
                df.columns = df.columns.str.strip()
                df = df[[col for col in df.columns if col in WHITELIST_COLUMNS_GROUPES_OPTION_DEFS]]
                df = df.dropna(axis=1, how="all")
                base_name = os.path.splitext(filename)[0]
                output_path = os.path.join(output, f"{base_name}_nettoye.csv")
                # df.to_csv(output_path, sep=";", index=False, encoding="utf-8")
                print(f"‚úÖ {filename} export√© : {output_path} ({df.shape[0]} lignes)")
                return df, os.path.splitext(filename)[0]
            except Exception as e:
                print(f"‚ùå Erreur sur {filename} : {e}")
                return None

# === MAIN ===
if __name__ == "__main__":
    (df_produit, base_name) = traiter_produit(return_df=True)
    df_attribut = traiter_attribut_produit(return_df=True)
    df_associe = charger_produit_associe()
    df_groupe_option = charger_groupe_option()
    # print(df_groupe_option.head())
    # print(df_produit[df_produit["Type"] == "Option"])
    if df_produit is not None and df_attribut is not None:
        xml_path = export_stepxml(df_produit, df_attribut, base_name, df_associe, df_groupe_option)

    df_lien_produit_option = charger_lien_produit_option()
    df_groupes_option_definitions, groupe_option_base_name = charger_groupe_option_definition()
    df_groupes_option_definitions = df_groupes_option_definitions[
        [col for col in df_groupes_option_definitions.columns if col in WHITELIST_COLUMNS_GROUPES_OPTION_DEFS]
    ]
    rattachement_dict = charger_rattachement()
    df_lien_produit_option, groupe_base_name = charger_lien_produit_option()

    if df_lien_produit_option is not None and not df_groupes_option_definitions.empty:
        build_step_groupe_option_file(df_lien_produit_option, df_groupes_option_definitions, rattachement_dict, groupe_option_base_name)